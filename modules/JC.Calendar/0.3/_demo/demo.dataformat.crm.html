<!doctype html>
<html>
<head>
<meta charset=utf-8 />
<title>360 75 team</title>
<style type='text/css'>
    *{ margin: 0; padding: 0; }
    body{  margin: 20px auto 20px; background:#ececec; }

    dl{
        margin: 20px 40px;
    }

    dt{
        font-weight: bold;
    }

    dd.odd {
        background: #ececec;
    }

    dl dd{ margin: 10px 0; }

    .error{ color: red; }
    input.error, select.error, textarea.error{ 
        background-color: #F0DC82;!important;
        box-shadow: 0 none;
    }
    input[type=text], input[type=password]{ width: 200px; }

    input, select, textarea {
        border: 1px solid #b9b9b9
    }

    input, select {
        height: 23px;
        line-height: 23px;
    }

    input[type=checkbox], input[type=radio], input.UXC{
        height: auto;
        line-height: auto;
    }

    select[multiple]{
        height: 80px;
    }

    div, li{
        margin: 2px auto;
    }

</style>
<link href='../../../../modules/JC.Tips/0.1/res/default/style.css' rel='stylesheet' />
<link href='../../../../modules/JC.Calendar/0.3/res/default/style.css' rel='stylesheet' />
<link href='../../../../modules/JC.Valid/0.2/res/default/style.css' rel='stylesheet' />
<script src="../../../../lib.js"></script>
<script src="../../../../config.js"></script>
<script>
    JC.debug = true; 

    requirejs( [ 'JC.Tips', 'JC.Calendar', 'plugins.json2', 'JC.Valid' ], function( Tips, Calendar ){

        JC.Tips.autoInit = false;

        JC.Calendar.layoutInitedCallback = 
            function( _layout ){
                JC.Tips.init( _layout.find('[title]') );
            };

        JC.Calendar.layoutHideCallback = 
            function( _lastIpt ){
                JC.Tips.hide();
            };

        var today = new Date();
        var maxDate = today;

        //$( 'input.testitem' ).val( JC.f.formatISODate( today ) );//.attr('maxvalue', JC.f.formatISODate( maxDate ) );

    });

    function calendarshow(){
        var _p = $(this);
        UXC.log( 'calendarshow', _p.val() );
    }

    function calendarhide(){
        var _p = $(this);
        UXC.log( 'calendarhide', _p.val() );
    }
    
    function calendarlayoutchange(){
        var _p = $(this);
        UXC.log( 'calendarlayoutchange', _p.val() );
    }

    function calendarupdate( _start, _end ){
        var _p = $(this);
        UXC.log( 'calendarupdate', _p.val(), _start, _end );
    }

    function calendarupdate( _start, _end ){
        var _p = $(this);
        UXC.log( 'calendarupdate', _p.val(), _start, _end );
    }
    //
    /// 针对周的日期格式化
    //
    function parseWeekDate( _dateStr ){
        _dateStr = $.trim( _dateStr || '' );
        var _r = { start: null, end: null };
        if( !_dateStr ) return _r;

        _dateStr = _dateStr.split( 'W' );

        var _year = parseInt( _dateStr[0], 10 ), _week = parseInt( _dateStr[1], 10 )
            , _sdate = JC.f.pureDate( new Date( _dateStr[0] ), 0, 1 )
            , _edate = JC.f.pureDate( new Date( _dateStr[1] ), 0, 1 )
            , _weeks = JC.f.weekOfYear( _dateStr[0], JC.Calendar.weekDayOffset )
            ;

        $( _weeks ).each( function( _ix, _item ){
            if( _item.week === _week ){
                _r.start = new Date();
                _r.end = new Date();

                _r.start.setTime( _item.start );
                _r.end.setTime( _item.end );
                return false;
            }
        });

        if( !_r.start ){
            _r.start = new Date();
            _r.end = new Date();
        }

        return _r;
    }
    //
    /// 针对月份日期格式化 YY-MM
    //
    function parseYearMonthDate( _dateStr ){
        _dateStr = $.trim( _dateStr || '' );
        var _r = { start: null, end: null };
        if( !_dateStr ) return _r;

        _dateStr = _dateStr.replace( /[^\d]+/g, '' );
        var _year = _dateStr.slice( 0, 4 ), _month = parseInt( _dateStr.slice( 4, 6 ), 10 ) - 1;

        _r.start = new Date( _year, _month, 1 );
        return _r;
    }
    //
    /// 针对季度日期格式化 YY-MM ~ YY-MM
    //
    function parseSeasonDate( _dateStr ){
        _dateStr = $.trim( _dateStr || '' );
        var _r = { start: null, end: null };
        if( !_dateStr ) return _r;

        _dateStr = _dateStr.replace( /[^\d]+/g, '' );

        _r.start = JC.f.parseISODate( _dateStr.slice( 0, 6 ) + '01' );
        _r.end = JC.f.parseISODate( _dateStr.slice( 6 ) + '01' );

        return _r;
    }

</script>
</head>    
<body>
    <br /><br /><br /><br /><br /><br />
    <form action='' method='get'>

        <dl>
            <dt>天</dt>
            <dd>
                <dl>
                    <dt>normal( date )</dt>
                    <dd>
                        <input type="text" 
                        multidate="date" 
                        currentcanselect="true" 
                        />
                    </dd>
                </dl>

                <dl>
                    <dt>date range( daterange )</dt>
                    <dd>
                        <input type="text" name="date2" value="" datatype="daterange" emel="/em" />
                        <input type="text" name="date2" value="" datatype="daterange" emel="/em" />
                        <em></em>
                    </dd>
                    <dd>
                        <input type="text" name="date2" value="" datatype="daterange" emel="/em" maxvalue="now" />
                        <input type="text" name="date2" value="" datatype="daterange" emel="/em" maxvalue="now" />
                        maxvalue="now"
                        <em></em>
                    </dd>
                </dl>

            </dd>
        </dl>

        <dl>
            <dt>周</dt>
            <dd>
                <dl>
                    <dt>normal( week )</dt>
                    <dd>
                        <input type="text" 
                        multidate="week" 
                        currentcanselect="true" 
                        /> 
                    </dd>
                    <dd>
                        <input type="text" 
                        multidate="week" 
                        currentcanselect="true" 
                        fullDateFormat="{0}"
                        dateFormat="YYWWK"
                        dateParse="parseWeekDate"
                        /> dateformat="YYWWK"
                    </dd>
                </dl>

                <dl>
                    <dt>week range( week range )</dt>
                    <dd>
                        <input type="text" value="" 
                            datatype="daterange"
                            multidate="week" 
                            currentcanselect="true" 
                            fullDateFormat="{0}"
                            dateFormat="YY-MM-DD"
                            emel="/em" 
                            />
                        <input type="text" value="" 
                            datatype="daterange"  
                            multidate="week" 
                            currentcanselect="true" 
                            fullDateFormat="{1}"
                            dateFormat="YY-MM-DD"
                            emel="/em" 
                            />
                        <em></em>
                    </dd>
                    <dd>
                        <input type="text" value="" 
                            datatype="daterange"
                            multidate="week" 
                            currentcanselect="true" 
                            fullDateFormat="{0}"
                            dateFormat="YYWWK"
                            dateParse="parseWeekDate"
                            emel="/em" 
                            />
                        <input type="text" value="" 
                            datatype="daterange"  
                            multidate="week" 
                            currentcanselect="true" 
                            fullDateFormat="{0}"
                            dateFormat="YYWWK"
                            dateParse="parseWeekDate"
                            emel="/em" 
                            /> 
                            dateformat="YYWWK"
                        <em></em>
                    </dd>
                    <dd>
                        <input type="text" value="" 
                            datatype="daterange"
                            multidate="week" 
                            currentcanselect="true" 
                            fullDateFormat="{0}"
                            dateFormat="YYWWK"
                            dateParse="parseWeekDate"
                            maxvalue="now"
                            emel="/em" 
                            />
                        <input type="text" value="" 
                            datatype="daterange"  
                            multidate="week" 
                            currentcanselect="true" 
                            fullDateFormat="{0}"
                            dateFormat="YYWWK"
                            dateParse="parseWeekDate"
                            maxvalue="now"
                            emel="/em" 
                            /> 
                            dateformat="YYWWK"
                            , maxvalue="now"
                        <em></em>
                    </dd>
                </dl>
            </dd>
        </dl>


    </form>

    <div style="height:3000px;"></div>
    <div style="height:20px;width: 3000px;"></div>
</body>
</html>


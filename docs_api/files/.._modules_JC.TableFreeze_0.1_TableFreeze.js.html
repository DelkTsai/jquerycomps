<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../modules/JC.TableFreeze/0.1/TableFreeze.js - jquery components</title>
    <link rel="stylesheet" href="../assets/css/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/widget.css">
    <link rel="stylesheet" href="../assets/css/tabview.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="../assets/js/yui-min.js"></script>
    <script src="../assets/js/comps1.js"></script>
    <script src="../assets/js/comps2.js"></script>
    <script src="../assets/js/comps3.js"></script>
    <script src="../assets/js/comps4.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../jc_logo.png" title="jquery components"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/JC.AjaxUpload.html">JC.AjaxUpload</a></li>
            
                <li><a href="../classes/JC.alert.html">JC.alert</a></li>
            
                <li><a href="../classes/JC.AutoChecked.html">JC.AutoChecked</a></li>
            
                <li><a href="../classes/JC.AutoComplete.html">JC.AutoComplete</a></li>
            
                <li><a href="../classes/JC.AutoSelect.html">JC.AutoSelect</a></li>
            
                <li><a href="../classes/JC.BaseMVC.html">JC.BaseMVC</a></li>
            
                <li><a href="../classes/JC.BaseMVC.Model.html">JC.BaseMVC.Model</a></li>
            
                <li><a href="../classes/JC.Calendar.html">JC.Calendar</a></li>
            
                <li><a href="../classes/JC.common.html">JC.common</a></li>
            
                <li><a href="../classes/JC.confirm.html">JC.confirm</a></li>
            
                <li><a href="../classes/JC.DCalendar.html">JC.DCalendar</a></li>
            
                <li><a href="../classes/JC.Dialog.html">JC.Dialog</a></li>
            
                <li><a href="../classes/JC.Dialog.alert.html">JC.Dialog.alert</a></li>
            
                <li><a href="../classes/JC.Dialog.confirm.html">JC.Dialog.confirm</a></li>
            
                <li><a href="../classes/JC.Dialog.mask.html">JC.Dialog.mask</a></li>
            
                <li><a href="../classes/JC.Dialog.msgbox.html">JC.Dialog.msgbox</a></li>
            
                <li><a href="../classes/JC.Drag.html">JC.Drag</a></li>
            
                <li><a href="../classes/JC.f.html">JC.f</a></li>
            
                <li><a href="../classes/JC.Fixed.html">JC.Fixed</a></li>
            
                <li><a href="../classes/JC.Form.html">JC.Form</a></li>
            
                <li><a href="../classes/JC.FormFillUrl.html">JC.FormFillUrl</a></li>
            
                <li><a href="../classes/JC.hideAllPanel.html">JC.hideAllPanel</a></li>
            
                <li><a href="../classes/JC.hideAllPopup.html">JC.hideAllPopup</a></li>
            
                <li><a href="../classes/JC.ImageCutter.html">JC.ImageCutter</a></li>
            
                <li><a href="../classes/JC.LunarCalendar.html">JC.LunarCalendar</a></li>
            
                <li><a href="../classes/JC.LunarCalendar.Model.html">JC.LunarCalendar.Model</a></li>
            
                <li><a href="../classes/JC.LunarCalendar.View.html">JC.LunarCalendar.View</a></li>
            
                <li><a href="../classes/JC.msgbox.html">JC.msgbox</a></li>
            
                <li><a href="../classes/JC.Panel.html">JC.Panel</a></li>
            
                <li><a href="../classes/JC.Panel.Model.html">JC.Panel.Model</a></li>
            
                <li><a href="../classes/JC.Panel.View.html">JC.Panel.View</a></li>
            
                <li><a href="../classes/JC.Placeholder.html">JC.Placeholder</a></li>
            
                <li><a href="../classes/JC.PopTips.html">JC.PopTips</a></li>
            
                <li><a href="../classes/JC.Slider.html">JC.Slider</a></li>
            
                <li><a href="../classes/JC.Slider.Model.html">JC.Slider.Model</a></li>
            
                <li><a href="../classes/JC.Suggest.html">JC.Suggest</a></li>
            
                <li><a href="../classes/JC.Tab.html">JC.Tab</a></li>
            
                <li><a href="../classes/JC.Tab.Model.html">JC.Tab.Model</a></li>
            
                <li><a href="../classes/JC.Tab.View.html">JC.Tab.View</a></li>
            
                <li><a href="../classes/JC.TableFreeze.html">JC.TableFreeze</a></li>
            
                <li><a href="../classes/JC.Tips.html">JC.Tips</a></li>
            
                <li><a href="../classes/JC.Tips.Model.html">JC.Tips.Model</a></li>
            
                <li><a href="../classes/JC.Tips.View.html">JC.Tips.View</a></li>
            
                <li><a href="../classes/JC.Tree.html">JC.Tree</a></li>
            
                <li><a href="../classes/JC.Tree.Model.html">JC.Tree.Model</a></li>
            
                <li><a href="../classes/JC.Valid.html">JC.Valid</a></li>
            
                <li><a href="../classes/window.Bizs.ActionLogic.html">window.Bizs.ActionLogic</a></li>
            
                <li><a href="../classes/window.Bizs.AutoSelectComplete.html">window.Bizs.AutoSelectComplete</a></li>
            
                <li><a href="../classes/window.Bizs.ChangeLogic.html">window.Bizs.ChangeLogic</a></li>
            
                <li><a href="../classes/window.Bizs.CommonModify.html">window.Bizs.CommonModify</a></li>
            
                <li><a href="../classes/window.Bizs.DisableLogic.html">window.Bizs.DisableLogic</a></li>
            
                <li><a href="../classes/window.Bizs.DropdownTree.html">window.Bizs.DropdownTree</a></li>
            
                <li><a href="../classes/window.Bizs.FormLogic.html">window.Bizs.FormLogic</a></li>
            
                <li><a href="../classes/window.Bizs.KillISPCache.html">window.Bizs.KillISPCache</a></li>
            
                <li><a href="../classes/window.Bizs.MoneyTips.html">window.Bizs.MoneyTips</a></li>
            
                <li><a href="../classes/window.Bizs.MultiDate.html">window.Bizs.MultiDate</a></li>
            
                <li><a href="../classes/window.jQuery.html">window.jQuery</a></li>
            
                <li><a href="../classes/window.requirejs.html">window.requirejs</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../modules/JC.TableFreeze/0.1/TableFreeze.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
 ;(function(define, _win) { &#x27;use strict&#x27;; define( [ &#x27;JC.BaseMVC&#x27; ], function(){
/**
 * TableFreeze 表格固定指定列功能
 *
 *&lt;p&gt;&lt;b&gt;require&lt;/b&gt;:
 *   &lt;a href=&quot;widnow.jQuery.html&quot;&gt;jQuery&lt;/a&gt;
 *   , &lt;a href=&quot;JC.common.html&quot;&gt;JC.common&lt;/a&gt;
 *   , &lt;a href=&#x27;JC.BaseMVC.html&#x27;&gt;JC.BaseMVC&lt;/a&gt;
 *&lt;/p&gt;
 *
 *&lt;p&gt;&lt;a href=&#x27;https://github.com/openjavascript/jquerycomps&#x27; target=&#x27;_blank&#x27;&gt;JC Project Site&lt;/a&gt;
 *   | &lt;a href=&#x27;http://jc2.openjavascript.org/docs_api/classes/JC.TableFreeze.html&#x27; target=&#x27;_blank&#x27;&gt;API docs&lt;/a&gt;
 *   | &lt;a href=&#x27;../../modules/JC.TableFreeze/0.1/_demo&#x27; target=&#x27;_blank&#x27;&gt;demo link&lt;/a&gt;&lt;/p&gt;
 *  
 *&lt;h2&gt;页面只要引用本文件, 默认会自动初始化div为class=&quot;js_compTableFreeze&quot;下的表格&lt;/h2&gt;
 *&lt;p&gt;目前不支持带有tfooter的表格。如果表格带有tfooter，tfooter部分的内容会被清空&lt;/p&gt;
 *&lt;p&gt;&lt;/p&gt;
 *
 *
 *&lt;h2&gt;可用的 HTML attribute&lt;/h2&gt;
 *
 *&lt;dl&gt;
 *    &lt;dt&gt;freezeType = string&lt;/dt&gt;
 *    &lt;dd&gt;
 *       声明表格列冻结的类型：
 *       &lt;p&gt;&lt;b&gt;prev：&lt;/b&gt;左边的列固定，其他滚动&lt;/p&gt;
 *       &lt;p&gt;&lt;b&gt;next：&lt;/b&gt;右边的列固定，其他滚动&lt;/p&gt;
 *       &lt;p&gt;&lt;b&gt;both：&lt;/b&gt;两边的列固定，其他滚动&lt;/p&gt;
 *    &lt;/dd&gt;
 *
 *    &lt;dt&gt;freezeCol = string&lt;/dt&gt;
 *    &lt;dd&gt;
 *        声明表格要冻结的列数:
 *        &lt;p&gt;为&lt;b&gt;0：&lt;/b&gt;全部滚动，不冻结&lt;/p&gt;
 *        &lt;p&gt;为&lt;b&gt;列表数目：&lt;/b&gt;全部冻结， 不滚动&lt;/p&gt;
 *        &lt;p&gt;为&lt;b&gt;num,num：&lt;/b&gt;freezeType为&lt;b&gt;both&lt;/b&gt;时，第一个数字表示前面冻结的列数&lt;br/&gt;
 *          第二个数字表示后面冻结的列数。&lt;br/&gt;
 *           当两个数字加起来等于列数时，表示全部冻结，不会出现有滚动的列。
 *        &lt;/p&gt;
 *    &lt;/dd&gt;
 *
 *    &lt;dt&gt;scrollWidth = num&lt;/dt&gt;
 *    &lt;dd&gt;
 *        声明表格滚动部分的宽度，默认120%
 *    &lt;/dd&gt;
 *
 *    &lt;dt&gt;needHoverClass = true|false&lt;/dt&gt;
 *    &lt;dd&gt;
 *        声明表格行是否需要鼠标hover高亮效果:
 *        &lt;p&gt;默认值为true&lt;/p&gt;
 *    &lt;/dd&gt;
 *
 *    &lt;dt&gt;hoverClass = string&lt;/dt&gt;
 *    &lt;dd&gt;
 *        声明表格行高亮的className:
 *        &lt;p&gt;默认值为compTFHover&lt;/p&gt;
 *    &lt;/dd&gt;
 *
 *    &lt;dt&gt;beforeCreateTableCallback = function&lt;/dt&gt;
 *    &lt;dd&gt;
 *        表格创建前, 触发的回调, &lt;b&gt;window 变量域&lt;/b&gt;
&lt;pre&gt;function beforeCreateTableCallback( _selector ){
    var _ins = this;
    JC.log( &#x27;beforeCreateTableCallback&#x27;, new Date().getTime() );
}&lt;/pre&gt;
 *    &lt;/dd&gt;
 *
 *    &lt;dt&gt;afterCreateTableCallback = function&lt;/dt&gt;
 *    &lt;dd&gt;
 *        表格创建后, 触发的回调, &lt;b&gt;window 变量域&lt;/b&gt;
&lt;pre&gt;function afterCreateTableCallback( _selector ){
    var _ins = this;
    JC.log( &#x27;afterCreateTableCallback&#x27;, new Date().getTime() );
}&lt;/pre&gt;
 *    &lt;/dd&gt;
 *&lt;/dl&gt; 
 *
 * @namespace JC
 * @class TableFreeze
 * @extends JC.BaseMVC
 * @constructor
 * @param   {selector|string}   _selector   
 * @version dev 0.1 2013-11-25
 * @author  zuojing   &lt;zuojing1013@gmail.com&gt; | 75 Team
 * @example
        &lt;script&gt;
            JC.debug = true;
            JC.use(&#x27;TableFreeze&#x27;);
        &lt;/script&gt;
        &lt;dl class=&quot;defdl&quot;&gt;
            &lt;dt&gt;TableFreeze example&lt;/dt&gt;
            &lt;dd&gt;
                &lt;dl&gt;
                    &lt;dd&gt;
                        &lt;div class=&quot;js_compTableFreeze&quot; freezeType=&quot;prev&quot; freezeCols=&quot;2&quot; /&gt;
                            &lt;dl&gt;
                                &lt;dd&gt;
                                    &lt;table &gt;
                                        &lt;thead&gt;
                                            &lt;tr&gt;
                                                &lt;th &gt; 
                                                    item0
                                                &lt;/th&gt;
                                                &lt;th &gt;
                                                    item1
                                                &lt;/th&gt;
                                                &lt;th &gt;
                                                    item2
                                                &lt;/th&gt;
                                                &lt;th &gt;
                                                    item3
                                                &lt;/th&gt;
                                                &lt;th &gt;
                                                    item4
                                                &lt;/th&gt;
                                            &lt;/tr&gt;
                                        &lt;/thead&gt;
                                        &lt;tbody&gt;
                                            &lt;tr&gt;
                                                &lt;td rowspan=&quot;3&quot;&gt;
                                                    col01
                                                &lt;/td&gt;
                                                &lt;td class=&quot;breaklw&quot; &gt;
                                                    我的我的我的我的我的我的我的我的我的
                                                &lt;/td&gt;
                                                &lt;td rowspan=&quot;2&quot; colspan=&quot;2&quot;&gt;
                                                    col02
                                                &lt;/td&gt;
                                                
                                                &lt;td&gt;
                                                    col04
                                                &lt;/td&gt;

                                            &lt;/tr&gt;
                                            &lt;tr&gt;
                                                &lt;td &gt;
                                                    col11
                                                &lt;/td&gt;
                                                
                                                &lt;td &gt;
                                                    col14
                                                &lt;/td&gt;
                                            &lt;/tr&gt;
                                              &lt;tr&gt;
                                               
                                                &lt;td&gt;
                                                    col21
                                                &lt;/td&gt;
                                                 &lt;td colspan=&quot;3&quot;&gt;
                                                    col22
                                                &lt;/td&gt;
                                            &lt;/tr&gt;
                                            &lt;tr&gt;
                                                &lt;td&gt;
                                                    col30
                                                &lt;/td&gt;
                                                &lt;td rowspan=&quot;2&quot;&gt;
                                                    col31
                                                &lt;/td&gt;
                                                 &lt;td&gt;
                                                    col32
                                                &lt;/td&gt;
                                                 &lt;td&gt;
                                                    col33
                                                &lt;/td&gt;
                                                &lt;td rowspan=&quot;2&quot;&gt;
                                                    col34
                                                &lt;/td&gt;
                                            &lt;/tr&gt;
                                            &lt;tr&gt;
                                                &lt;td&gt;
                                                    col40
                                                &lt;/td&gt;
                                                
                                                 &lt;td&gt;
                                                    col42
                                                &lt;/td&gt;
                                                 &lt;td&gt;
                                                    col43
                                                &lt;/td&gt;
                                            &lt;/tr&gt;
                                            
                                        &lt;/tbody&gt;
                                    &lt;/table&gt;
                                &lt;/dd&gt;
                            &lt;/dl&gt;
                        &lt;/div&gt;
                    &lt;dd&gt;
                &lt;/dl&gt;
            &lt;/dd&gt;
        &lt;/dl&gt;
 */
    JC.TableFreeze = TableFreeze;
 
    function TableFreeze( _selector ){
        _selector &amp;&amp; ( _selector = $( _selector ) );
        
        if( TableFreeze.getInstance( _selector ) ) return TableFreeze.getInstance( _selector );
        TableFreeze.getInstance( _selector, this );
        //JC.log( TableFreeze.Model._instanceName );
 
        this._model = new TableFreeze.Model( _selector );
        this._view = new TableFreeze.View( this._model );
 
        this._init();
 
        //JC.log( &#x27;TableFreeze:&#x27;, new Date().getTime() );
    }
    /**
     * 获取或设置 TableFreeze 的实例
     * @method  getInstance
     * @param   {selector}      _selector
     * @static
     * @return  {TableFreezeInstance}
     */
    TableFreeze.getInstance = function ( _selector, _setter ) {
        if( typeof _selector == &#x27;string&#x27; &amp;&amp; !/&lt;/.test( _selector ) ) 
            _selector = $(_selector);
        if( !(_selector &amp;&amp; _selector.length ) || ( typeof _selector == &#x27;string&#x27; ) ) return;
        typeof _setter != &#x27;undefined&#x27; &amp;&amp; _selector.data( TableFreeze.Model._instanceName, _setter );

        return _selector.data( TableFreeze.Model._instanceName );
    };
    /**
     * 初始化可识别的 TableFreeze 实例
     * @method  init
     * @param   {selector}      _selector
     * @static
     * @return  {Array of TableFreezeInstance}
     */
    TableFreeze.init = function ( _selector ) {
        var _r = [];
        
        _selector = $( _selector || document );

        if ( _selector.length ) {
            if ( _selector.hasClass(&#x27;js_compTableFreeze&#x27;) ) {
                _r.push( new TableFreeze(_selector) );
            } else {
                _selector.find(&#x27;div.js_compTableFreeze&#x27;).each( function() {
                    _r.push( new TableFreeze( this ) );
                });
            }
        }
        
        return _r;
    };

    BaseMVC.build( TableFreeze );

    JC.f.extendObject( TableFreeze.prototype, {
        _beforeInit: function () {
            //JC.log( &#x27;TableFreeze _beforeInit&#x27;, new Date().getTime() );
        },

        _initHanlderEvent: function () {
            var _p = this;

            _p.on( &#x27;CTableFreezeUpdate&#x27;, function( _evt ){
                _p._model.beforeCreateTableCallback()
                    &amp;&amp; _p._model.beforeCreateTableCallback().call( _p, _p.selector() );
                
                _p._view.update();

                _p._model.afterCreateTableCallback()
                    &amp;&amp; _p._model.afterCreateTableCallback().call( _p, _p.selector() );
                
                if ( _p._model.needHoverClass() ) {
                    var _hover = _p._model.hoverClass();

                    if ( !_p._model.supportFreeze() || !_p._model.supportScroll() ) {
                        _p._model.selector().find(&#x27;table&gt;tbody&gt;tr&#x27;)
                            .on(&#x27;mouseenter&#x27;, function () {
                                $(this).addClass( _hover );
                            })
                            .on(&#x27;mouseleave&#x27;, function () {
                                $(this).removeClass( _hover );
                            });
                    } else {

                        var _trs = &#x27;td.compTFEextraTd&gt;div&gt;table&gt;tbody&gt;tr&#x27;,
                            _brother = &#x27;td.compTFEextraTd&gt;div&gt;table&gt;tbody&gt;tr.&#x27;,
                            _el;

                        $(document).undelegate(_trs, &#x27;mouseenter&#x27;)
                            .delegate(_trs, &#x27;mouseenter&#x27;, function () {
                                var _sp = $(this),
                                    _pnt = JC.f.getJqParent(_sp, &#x27;table.compTFEextraTable&#x27;);
                                
                                _el = _pnt.find( _brother + _sp.data(&#x27;linktr&#x27;) ).addClass(_hover);
                              
                            }).undelegate(_trs, &#x27;mouseleave&#x27;)
                            .delegate(_trs, &#x27;mouseleave&#x27;, function () {
                                if ( _el &amp;&amp; _el.length &gt; 0 ) {
                                    _el.removeClass(_hover);
                                }
                            });
                    }

                }

            });

            
        }, 

        _inited: function () {
            //JC.log( &#x27;TableFreeze _inited&#x27;, new Date().getTime() );
           var _p = $(this);

           _p.trigger(&#x27;CTableFreezeUpdate&#x27;);

        },

        /**
         * 更新 TableFreeze 状态
         * @method update
         */
        update: function () {
            this._view.update();

            return this;

        },

        /**
         * resize时更新 TableFreeze 状态
         * @method fixHeight
        */
        fixHeight: function () {
            var _p = this,
                _wArr = TableFreeze.Model.saveWidth,
                _selector = _p._model.selector(),
                _newWArr = _selector.prop(&#x27;offsetWidth&#x27;),
                _els = _selector.find(&#x27;div.js-roll-table,div.js-fixed-table&#x27;),
                _scrollTable = _selector.find(&#x27;div.js-roll-table&#x27;),
                _fixedTable = _selector.find(&#x27;div.js-fixed-table&#x27;),
                _fixedWidth = 0;

            TableFreeze.Model.windowWidth = $(window).width();

            _p._model.setHeight();
            
            if ( _wArr &lt;= _newWArr ) {
                
                _els.each( function () {
                    $(this).find(&#x27;tr&#x27;).height(&#x27;auto&#x27;);
                } );

                _p._model.setHeight();
                
            }   


            _fixedTable.each( function () {
                _fixedWidth += $(this).parent(&#x27;td&#x27;).prop(&#x27;offsetWidth&#x27;);
            } );

            _scrollTable.css(&#x27;width&#x27;, _newWArr - _fixedWidth);
            _p._model.fixWidth();

            //$(&#x27;#t21&#x27;).append(&#x27;&lt;p&gt;&#x27; +  _newWArr + &#x27;   &#x27; + (_newWArr - _fixedWidth)  + &#x27;&lt;/p&gt;&#x27;);
            return this;       

        }

    });
 
    TableFreeze.Model._instanceName = &quot;TableFreeze&quot;;
    TableFreeze.Model.saveWidth = 0;
    TableFreeze.Model.windowWidth = 0;
   
    JC.f.extendObject( TableFreeze.Model.prototype, {
        init: function () {
            var _p = this;

            this.sourceTable = this.selector().find(&#x27;table&#x27;).eq(0);
        },

        detachTable: function () {
            //this.sourceTable.detach();
            this.sourceTable.remove();
        },

        linkTpl: function () {
            var _p = this,
                _trs;

            if ( _p.selector().find(&#x27;table&gt;tbody&#x27;).length &gt; 0 ) {
                _trs = _p.selector().find(&#x27;table&gt;tbody&gt;tr&#x27;);
            } else {
                _trs = _p.selector().find(&#x27;table&gt;tr&#x27;);
            }

            _trs.each( function ( _ix ) {
                $(this).attr(&#x27;data-linktr&#x27;, &#x27;CTF&#x27; + _ix);
            });
            
        },

        createTplBox: function () {
            var _p = this,
                _ftype = _p.freezeType(),
                _baseTpl = _p.tTpl(),
                _selector = _p.selector(),
                _colNum = _p.colNum(),
                _tpl ,
                _fcols,
                _thead,
                _tbody,
                _thead2,
                _tbody2;

            var _pnt1,
                _pnt2,
                _pnt3,
                _forePnt;

            switch( _ftype ) {
                case &#x27;prev&#x27;:
                    {
                        _fcols = parseInt( _p.freezeCols(), 10 ); 

                        _tpl = JC.f.printf(_baseTpl, 
                            &#x27;js-fixed-table compTFPrevFixed&#x27;, 
                            &#x27;js-roll-table compTFPrevRoll&#x27; );
                        _selector.append( _tpl );

                        _pnt1 = JC.f.getJqParent(_selector.find(&#x27;.js-fixed-table&#x27;), &#x27;.compTFEextraTd&#x27;);
                        _pnt2 = JC.f.getJqParent(_selector.find(&#x27;.js-roll-table&#x27;), &#x27;.compTFEextraTd&#x27;);
                        
                        //if ( !_p.hasFixedPXWidth() ) {
                            _p.setWidth(0, _pnt1, _fcols, _pnt2);
                            //_p.setWidth(_fcols, _pnt2, _colNum); 
                        //}

                        _thead = _selector.find(&#x27;.js-fixed-table&gt;table&gt;thead&#x27;);
                        _tbody = _selector.find(&#x27;.js-fixed-table&gt;table&gt;tbody&#x27;);
                        _thead2 = _selector.find(&#x27;.js-roll-table&gt;table&gt;thead&#x27;);
                        _tbody2 = _selector.find(&#x27;.js-roll-table&gt;table&gt;tbody&#x27;);

                        _p.createHdTpl( _thead, _fcols );
                        _p.createBdTpl( _tbody, _fcols );

                        _p.createHdTpl( _thead2, _colNum - _fcols );
                        _p.createBdTpl( _tbody2, _colNum - _fcols );

                        break;
                    }
                   
                case &#x27;last&#x27;:
                    {
                        _fcols = parseInt( _p.freezeCols(), 10 );

                        _tpl = JC.f.printf(_baseTpl, 
                            &#x27;js-roll-table compTFLastRoll&#x27;, 
                            &#x27;js-fixed-table compTFLastFixed&#x27;)
                        _selector.append( _tpl );

                        _pnt1 = JC.f.getJqParent(_selector.find(&#x27;div.js-roll-table&#x27;), &#x27;td.compTFEextraTd&#x27;);
                        _pnt2 = JC.f.getJqParent(_selector.find(&#x27;div.js-fixed-table&#x27;), &#x27;td.compTFEextraTd&#x27;);

                        //if ( !_p.hasFixedPXWidth() ) {
                            //_p.setWidth(0, _pnt1, _colNum - _fcols  );
                            _p.setWidth(_colNum - _fcols, _pnt2, _colNum, _pnt1 );
                        //}

                        _thead = _selector.find(&#x27;div.js-roll-table&gt;table&gt;thead&#x27;);
                        _tbody = _selector.find(&#x27;div.js-roll-table&gt;table&gt;tbody&#x27;);
                        _thead2 = _selector.find(&#x27;div.js-fixed-table&gt;table&gt;thead&#x27;);
                        _tbody2 = _selector.find(&#x27;div.js-fixed-table&gt;table&gt;tbody&#x27;);

                        _p.createHdTpl( _thead, _colNum - _fcols );
                        _p.createBdTpl( _tbody, _colNum - _fcols );
                        
                        _p.createHdTpl( _thead2, _fcols );
                        _p.createBdTpl( _tbody2, _fcols );

                        break;
                    }  
                       
                case &#x27;both&#x27;:
                    {   
                        var _fcols2,
                            _thead3,
                            _tbody3;

                        _fcols = parseInt( _p.freezeCols()[0], 10 );
                        _fcols2 = parseInt( _p.freezeCols()[1], 10 );

                        _tpl = JC.f.printf(_baseTpl, 
                                &#x27;js-fixed-table compTFBothFixed&#x27;,
                                &#x27;js-roll-table compTFBothRoll&#x27;,
                                &#x27;js-fixed-table compTFBothFixed&#x27;);
                        _selector.append( _tpl );

                        _pnt1 = JC.f.getJqParent(_selector.find(&#x27;div.js-fixed-table:eq(0)&#x27;), &#x27;td.compTFEextraTd&#x27;);
                        _pnt2 = JC.f.getJqParent(_selector.find(&#x27;div.js-roll-table&#x27;), &#x27;td.compTFEextraTd&#x27;);
                        _pnt3 = JC.f.getJqParent(_selector.find(&#x27;div.js-fixed-table:eq(1)&#x27;), &#x27;td.compTFEextraTd&#x27;);

                        //if ( !_p.hasFixedPXWidth() ) {
                            _p.setWidth(0, _pnt1, _fcols  );
                            _p.setWidth(_fcols, _pnt2,  _fcols + _colNum - _fcols - _fcols2 );
                            _p.setWidth(_fcols + _colNum - _fcols - _fcols2, _pnt3, _colNum );
                        //}

                        _thead = _selector.find(&#x27;div.js-fixed-table:eq(0)&gt;table&gt;thead&#x27;);
                        _tbody = _selector.find(&#x27;div.js-fixed-table:eq(0)&gt;table&gt;tbody&#x27;);
                        _thead2 = _selector.find(&#x27;div.js-roll-table&gt;table&gt;thead&#x27;);
                        _tbody2 = _selector.find(&#x27;div.js-roll-table&gt;table&gt;tbody&#x27;);
                        _thead3 = _selector.find(&#x27;div.js-fixed-table:eq(1)&gt;table&gt;thead&#x27;);
                        _tbody3 = _selector.find(&#x27;div.js-fixed-table:eq(1)&gt;table&gt;tbody&#x27;);

                        _p.createHdTpl( _thead, _fcols );
                        _p.createBdTpl( _tbody, _fcols );
                        _p.createHdTpl( _thead2, _colNum - _fcols - _fcols2 );
                        _p.createBdTpl( _tbody2, _colNum - _fcols - _fcols2 );
                        _p.createHdTpl( _thead3, _fcols2 );
                        _p.createBdTpl( _tbody3, _fcols2 );

                        break;
                    }
                   
            }

           // _forePnt = JC.f.getJqParent(_pnt1, &#x27;table&#x27;);
            // if ( _p.hasFixedPXWidth() ) {
            //     _forePnt.css(&#x27;width&#x27;, _selector.find(&#x27;table&#x27;).prop(&#x27;offsetWidth&#x27;) );
            // }
            _selector.find(&#x27;div.js-roll-table&gt;table&#x27;).width(_p.scrollwidth());
            _p.setHeight();
           
        },

        createHdTpl: function ( _thead, _fc ) {
            var _p = this,
                _stpl = _p.sourceTable,
                _fragment = document.createDocumentFragment(),
                _$fragment = $(_fragment);

            _stpl.find(&#x27;thead:eq(0)&gt;tr&#x27;).each( function ( _ix, _item ) {

                var _cix = 0,
                    _tr,
                    _cloneTr = $(_item).get(0).cloneNode(false);

                _$fragment.append(_cloneTr);
                _tr = _$fragment.children(&#x27;tr:last&#x27;);

                $( _item ).children(&#x27;td,th&#x27;).each( function ( _six, _sitem ) {
                    
                    var _colspan = $(this).attr(&#x27;colspan&#x27;);

                    if ( _cix &gt;= _fc ) {
                      return false;
                    }

                    $(this).appendTo( _tr );
                    
                    if ( typeof _colspan === &#x27;undefined&#x27; ) {
                        _cix = _cix + 1;
                    } else {
                        _cix += parseInt(_colspan, 10);
                    }

                });
                
            });

            _$fragment.appendTo( _thead );   
        },

        createBdTpl: function ( _tbody, _fc ) {

            var _p = this,
                _stpl = _p.sourceTable,
                _strs = _stpl.find(&#x27;tbody:eq(0)&gt;tr&#x27;),
                _row = {},
                _fragment = document.createDocumentFragment(),
                _$fragment = $(_fragment);

            _strs.each( function ( _ix, _item ) {
                var _sp = $(this),
                    _cloneTr = _sp.get(0).cloneNode(false),
                    _stds =  _sp.children(&#x27;td,th&#x27;),
                    _cix = 0,
                    _tr;

                $(_cloneTr).addClass(&#x27;CTF CTF&#x27; + _ix).removeAttr(&#x27;id&#x27;);    
                _$fragment.append( _cloneTr );
                _tr = _$fragment.children(&#x27;tr:last&#x27;);

                _stds.each( function ( _six, _sitem ) {
                    
                    var _sp = $(this), 
                        _colspan = _sp.attr(&#x27;colspan&#x27;),
                        _rowspan = _sp.attr(&#x27;rowspan&#x27;),
                        _obj = {},
                        _key;
                    
                    if ( _cix &gt;= _fc ) {
                      return false;
                    }

                    if ( typeof _rowspan != &#x27;undefined&#x27; ) {
                        _rowspan = parseInt(_rowspan, 10);

                        _obj = {
                            six: _six,
                            rowspan: _rowspan
                        };

                        for ( var i = 1; i &lt; _rowspan; i++ ) {
                            if ( _six == 0 ) {
                                _row[(_ix + i) + ( _six + 1 ).toString()] = _obj;
                            } else {
                                _row[(_ix + i) + _six.toString()] = _obj;
                            }
                        }

                    }
                    
                    if ( typeof _colspan === &#x27;undefined&#x27; ) {
                        _cix = _cix + 1;
                    } else {
                        _cix += parseInt(_colspan, 10);
                    }

                    _key = _ix + (_six + 1).toString();
                    
                    if ( _key in _row  ) {
                        _cix = _cix + 1;
                    }

                    _sp.appendTo( _tr );

                });
             
            }); 

            _$fragment.appendTo( _tbody );  
            
        },

        setWidth: function (_i, _box, _cols, _scrollBox ) {
            var _wArr = this.colWidth(),
                _w = 0,
                i,
                _totalWidth = this.tableWidth(),
                _percentW = 0,
                _scrollBox = $(_scrollBox);

            for (i = _i; i &lt; _cols; i++ ) {
                _w = _w + _wArr[i];

            }
            _w = _w + 1;
            _percentW  = _w / _totalWidth;
            _percentW  = _percentW  * 100;

           $(_box).css(&#x27;width&#x27;, _percentW  + &#x27;%&#x27;);
            
            if ( _scrollBox.length ) {
                _scrollBox.css(&#x27;width&#x27;, (100 - _percentW ) + &#x27;%&#x27; )
                .find(&#x27;&gt;div&#x27;).css(&#x27;width&#x27;, _totalWidth - _w - 1);
            }
    
        },

        fixWidth: function () {
            var _initWidth = TableFreeze.Model.windowWidth,
                _winWidth = $(window).width(),
                _scrollBox = this.selector().find(&#x27;.js-roll-table&#x27;),
                _w = _scrollBox.width();

            if ( _initWidth &lt; _winWidth ) {
                _w += _winWidth - _initWidth;
                _scrollBox.width( _w ); 
                
            } else {
                _scrollBox.width( _w ); 
            }

            //$(&#x27;#t21&#x27;).append(&#x27;update&#x27; + &#x27;TableFreeze.Model.windowWidth&#x27; + _initWidth + &#x27;,   windowWidth&#x27; + _winWidth  );

        },

        setHeight: function () {
            var _p = this,
                _ftype = _p.freezeType(),
                _leftTr = _p.selector().find(&#x27;div.js-fixed-table:eq(0)&gt;table&gt;thead&gt;tr,div.js-fixed-table:eq(0)&gt;table&gt;tbody&gt;tr&#x27;),
                _rightTr = _p.selector().find(&#x27;div.js-roll-table&gt;table&gt;thead&gt;tr,div.js-roll-table&gt;table&gt;tbody&gt;tr&#x27;),
                _midTr = _p.selector().find(&#x27;div.js-fixed-table:eq(1)&gt;table&gt;thead&gt;tr,div.js-fixed-table:eq(1)&gt;table&gt;tbody&gt;tr&#x27;);

            _leftTr.each( function ( _ix, _item ) {
                var _rightTrx = _rightTr.eq( _ix ),
                    _midTrx = _midTr.eq( _ix ),
                    _sp = $(_item),
                    _maxH;

                _maxH = Math.max( _sp.prop(&#x27;offsetHeight&#x27;), _rightTrx.prop(&#x27;offsetHeight&#x27;) );

                if ( _ftype == &#x27;both&#x27; ) {
                    _maxH = Math.max( _maxH, _midTrx.prop(&#x27;offsetHeight&#x27;) );
                }   

                _sp.height(_maxH);
                _rightTrx.height(_maxH);
                
                if ( _ftype == &#x27;both&#x27; ) {
                    _midTrx.height(_maxH);
                }
                
            } );

        },

        freezeType: function () {
            var _p = this,
                _r;
                
            _r = _p.attrProp( _p.selector(), &#x27;freezeType&#x27;) || &#x27;prev&#x27;;

            return _r;
        },
        
        freezeCols: function () {
            var _p = this,
                _r;

            _r = _p.attrProp( _p.selector(), &#x27;freezeCols&#x27;) || 1;
            _r = _r.split(&#x27;,&#x27;);

            return _r;
        },

        scrollwidth: function () {
            var _r = this.attrProp(&#x27;scrollwidth&#x27;);

            !_r &amp;&amp; ( _r = &#x27;120%&#x27; );

            return _r;
        },

        needHoverClass: function () {
            var _r = this.boolProp( this.selector().find(&#x27;table&#x27;).eq(0), &#x27;needHoverClass&#x27; );

            !_r &amp;&amp; ( _r = true );

            return _r;
        },

        hoverClass: function () {
            var _r = this.attrProp( this.selector().find(&#x27;table&#x27;).eq(0), &#x27;hoverClass&#x27; );

            !_r &amp;&amp; ( _r = &#x27;compTFHover&#x27; );

            return _r;

        },

        tableWidth: function () {
            var _p = this,
                _w = _p.selector().width(),
                _pnt = _p.selector().parent();

            /**
             * IE6下，当表格的宽度超出了实际可用宽度时，其父节点的宽度会跟随内容的宽度
            */
            while (1) {

                if ( _pnt &amp;&amp; _pnt.prop(&#x27;nodeName&#x27;).toUpperCase() === &#x27;BODY&#x27; ) break;

                if ( _pnt.width() &lt; _w ) {
                    _w = _pnt.width();
                    break;
                }

                _pnt = _pnt.parent();

            }

            return _w;
        },

        rowHeight: function () {
            var _p = this,
                _trs = _p.selector().find(&#x27;table tr&#x27;),
                _h = [];

            _trs.each( function () {
                _h.push( $(this).prop(&#x27;offsetHeight&#x27;)  + &#x27;px&#x27;);
            } );

            return _h;
        },

        scrollWidth: function () {
            var _p = this;

            return _p.selector().attr(&#x27;scrollWidth&#x27;);
        },

        colWidth: function () {
            var _p = this,
                _ths = _p.selector().find(&#x27;table&gt;thead th&#x27;),
                _ths,
                _w = [],
                _totalWidth = _p.tableWidth();

            _ths.each( function () {
                //_w.push( $(this).prop(&#x27;offsetWidth&#x27;) / _totalWidth );
                _w.push( $(this).prop(&#x27;offsetWidth&#x27;) );
            } );

            return _w;
        },

        colNum: function () {
            var _p = this,
                _num = 0;

            _num = _p.selector().find(&#x27;thead&gt;tr&gt;th&#x27;).length ;

            return _num;
        },  

        rowNum: function () {
            var _p = this,
                _num = 0;

            _num = _p.selector().find(&#x27;tbody&gt;tr&#x27;).length;

            return _num;
        },

        supportFreeze: function () {
            var _p = this,
                _r = true;

            if ( _p.freezeCols().length == 0 
                || ( _p.freezeCols().length == 1 
                    &amp;&amp; ( parseInt(_p.freezeCols(),10) == 0 ) 
                    || parseInt(_p.freezeCols(),10) &gt; _p.colNum() 
                    )
                || ( _p.freezeCols().length == 2
                    &amp;&amp; ( parseInt(_p.freezeCols()[0], 10) + parseInt(_p.freezeCols()[1], 10) &gt;= _p.colNum() ) 
                    ) 
                ) {
                _r = false;
            }

            return _r;
        },

        supportScroll: function () {
            var _p = this,
                _c = 0,
                _r = true;

            $.each( _p.freezeCols(), function (_ix, _val) {
                _c = _c + parseInt(_val, 10);
            });

            if ( _c == _p.colNum() ) {
                _r = false;
            }

            return _r;
        },

        hasFixedPXWidth: function () {
            var _p = this,
                _pntW = _p.selector().get(0).style.width,
                _selfW = _p.selector().find(&#x27;table&#x27;).eq(0).attr(&#x27;width&#x27;) 
                    || _p.selector().find(&#x27;table&#x27;).eq(0).get(0).style.width,
                _childrenW = _p.tdThHasFixedPXWidth(),
                _tag = true;

            if ( _pntW &amp;&amp; /%/.test( _pntW ) ) {
                
                if ( !_selfW || ( _selfW &amp;&amp; /%/.test(_selfW) )  ) {
                    return false;
                }
            }

            if ( !_selfW || ( _selfW &amp;&amp; /%/.test(_selfW) )  ) {
                return false;
            }   

            if ( !_childrenW ) {
                return false;
            }

            return true;
        },

        tdThHasFixedPXWidth: function () {
            var _p = this,
                _children = _p.selector().find(&#x27;table&#x27;).eq(0).find(&#x27;tr&#x27;).eq(0).find(&#x27;th,td&#x27;);

            _children.each( function () {
                var _sp = $(this),
                    _w = _sp.attr(&#x27;width&#x27;) || _sp.get(0).style.width;

                if ( !_w ) {
                    return false;
                }

                if ( _w &amp;&amp; /%/.test(_w) ) {
                    return false;
                }

            } );

            return true;

        },

        tTpl: function () {
            var _p = this,
                _table,
                _thead,
                _tbody,
                _tpl;

            _table = _p.selector().find(&#x27;table&#x27;).get(0).cloneNode(false);
            _thead = _p.selector().find(&#x27;thead&#x27;).get(0).cloneNode(false);
            _tbody = _p.selector().find(&#x27;tbody&#x27;).get(0).cloneNode(false);

            $(_thead).appendTo($(_table));
            $(_tbody).appendTo($(_table));

            $(_table).width(&#x27;100%&#x27;);

            switch ( _p.freezeType() ) {
                case &#x27;prev&#x27;:
                case &#x27;last&#x27;:
                    _tpl = &#x27;&lt;table class=&quot;compTFEextraTable&quot;&gt;&lt;tr&gt;&lt;td class=&quot;compTFEextraTd&quot;&gt;&lt;div class=&quot;{0}&quot; style=&quot;width:100%;&quot;&gt;&#x27;
                        + _table.outerHTML
                        + &#x27;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;compTFEextraTd&quot;&gt;&lt;div class=&quot;{1}&quot; style=&quot;width:100%;&quot;&gt;&#x27;
                        + _table.outerHTML
                        + &#x27;&lt;/div&gt;&lt;/td&gt;&#x27;
                        + &#x27;&lt;/tr&gt;&lt;/table&gt;&#x27;;
                    // _tpl = &#x27;&lt;div class=&quot;compTFEextraTable&quot;&gt;&#x27;
                    //     + &#x27;&lt;div class=&quot;compTFEextraTd&quot;&gt;&lt;div class=&quot;{0}&quot; style=&quot;width:100%;&quot;&gt;&#x27; + _table.outerHTML + &#x27;&lt;/div&gt;&lt;/div&gt;&#x27;
                    //     + &#x27;&lt;div class=&quot;compTFEextraTd&quot;&gt;&lt;div class=&quot;{1}&quot; style=&quot;width:100%;&quot;&gt;&#x27; + _table.outerHTML + &#x27; &lt;/div&gt;&lt;/div&gt;&#x27;
                    //     + &#x27;&lt;/div&gt;&#x27;
                    break;
                case &#x27;both&#x27;:
                    _tpl = &#x27;&lt;table class=&quot;compTFEextraTable&quot;&gt;&lt;tr&gt;&lt;td class=&quot;compTFEextraTd&quot;&gt;&lt;div class=&quot;{0}&quot; style=&quot;width:100%;&quot;&gt;&#x27;
                        + _table.outerHTML
                        + &#x27;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;compTFEextraTd&quot;&gt;&lt;div class=&quot;{1}&quot; style=&quot;width:100%;&quot;&gt;&#x27;
                        + _table.outerHTML
                        + &#x27;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;compTFEextraTd&quot;&gt;&lt;div class=&quot;{2}&quot; style=&quot;width:100%;&quot;&gt;&#x27;
                        + _table.outerHTML
                        + &#x27;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#x27;
                    break;
            }

            return _tpl;
        },


        /**
         * TableFreeze调用前的回调
         */
        beforeCreateTableCallback: function () {
            var _p = this,
                _selector = _p.selector(),
                _key = &#x27;beforeCreateTableCallback&#x27;;

            return _p.callbackProp(_selector, _key);
        },

        /**
         * TableFreeze调用后的回调
         */
        afterCreateTableCallback: function () {
            var _p = this,
                _selector = _p.selector(),
                _key = &#x27;afterCreateTableCallback&#x27;;

            return _p.callbackProp(_selector, _key);
        },

        baseTpl: &#x27;&lt;div class=&quot;{0}&quot; style=&quot;width:100%;&quot;&gt;&#x27;
                +       &#x27;&lt;table style=&quot;padding:0;margin:0;&quot;&gt;&#x27;
                +           &#x27;&lt;thead&gt;&#x27;
                +           &#x27;&lt;/thead&gt;&#x27;
                +            &#x27;&lt;tbody&gt;&#x27;
                +            &#x27;&lt;/tbody&gt;&#x27;
                +         &#x27;&lt;/table&gt;&#x27;
                +   &#x27;&lt;/div&gt;&#x27;
    });
 
    JC.f.extendObject( TableFreeze.View.prototype, {
        init: function () {
            var _p = this;

            _p._model.linkTpl();
        },

        update: function () {
            var _p = this;
            
            if ( !_p._model.supportScroll() ) {
                return;
            } 

            if ( !_p._model.supportFreeze() ) {
                _p._model.selector().css({&#x27;overflow-x&#x27;: &#x27;scroll&#x27;})
                    .addClass(&#x27;compTFAllRoll&#x27;)
                        .children(&#x27;table&#x27;).css(&#x27;width&#x27;, _p._model.scrollwidth() );
                
                return;
            }

            _p._model.createTplBox();
            _p._model.detachTable();
            _p._model.fixWidth();

        }

    });

    $(document).ready( function () {
        //$(&#x27;#t21&#x27;).append( &#x27;document.width&#x27; + $(document).width() + &#x27;,  window.width&#x27; + $(window).width() );
        
        var _insAr = 0,
            _win= $( window );

        TableFreeze.Model.windowWidth = _win.width();
        TableFreeze.autoInit
            &amp;&amp; ( _insAr = TableFreeze.init() )
            ;

        _win.on( &#x27;resize&#x27;, CTFResize );

        function CTFResize(){

            _win.off( &#x27;resize&#x27;, CTFResize );

            $( &#x27;div.js_compTableFreeze&#x27; ).each( function () {
                var _ins = TableFreeze.getInstance( $( this ) );
                _ins &amp;&amp; _ins.fixHeight() ;
                TableFreeze.Model.saveWidth = _ins._model.tableWidth();


            });

            _win.data( &#x27;CTFResizeTimeout&#x27; ) &amp;&amp; clearTimeout( _win.data( &#x27;CTFResizeTimeout&#x27; ) );
            _win.data( &#x27;CTFResizeTimeout&#x27;, setTimeout( function(){
                _win.off( &#x27;resize&#x27;, CTFResize );
                _win.on( &#x27;resize&#x27;, CTFResize );
            }, 200 ) );

        }

    });
 
    return JC.TableFreeze;
});}( typeof define === &#x27;function&#x27; &amp;&amp; define.amd ? define : 
        function ( _name, _require, _cb ) { 
            typeof _name == &#x27;function&#x27; &amp;&amp; ( _cb = _name );
            typeof _require == &#x27;function&#x27; &amp;&amp; ( _cb = _require ); 
            _cb &amp;&amp; _cb(); 
        }
        , window
    )
);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

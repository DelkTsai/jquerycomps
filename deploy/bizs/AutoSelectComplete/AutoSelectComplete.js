(function(b,a){b(["JC.BaseMVC","JC.AutoComplete","JC.AutoSelect"],function(){(function(d){window.Bizs=window.Bizs||{};Bizs.AutoSelectComplete=c;function c(e){e&&(e=d(e));if(c.getInstance(e)){return c.getInstance(e)}c.getInstance(e,this);this._model=new c.Model(e);this._view=new c.View(this._model);this._init();JC.log("AutoSelectComplete inited",new Date().getTime())}c.getInstance=function(e,f){if(typeof e=="string"&&!/</.test(e)){e=d(e)}if(!(e&&e.length)||(typeof e=="string")){return}typeof f!="undefined"&&e.data(c.Model._instanceName,f);return e.data(c.Model._instanceName)};c.init=function(e){var f=[];e=d(e||document);if(e&&e.length){if(e.hasClass(".js_bizAutoSelectComplete")){f.push(new c(e))}else{e.find("input.js_bizAutoSelectComplete").each(function(){f.push(new c(this))})}}return f};c.prototype={_beforeInit:function(){JC.log("AutoSelectComplete _beforeInit",new Date().getTime())},_initHanlderEvent:function(){var e=this;e.on("BASC_SELECT_CHANGED",function(g,i){JC.log("Bizs.AutoSelectComplete all changed",new Date().getTime());e.trigger("BASC_ALL_CHANGE",[i]);var h=i.val(),i,h,f;if(!h){e.trigger("BASC_CLEAR");e.trigger("BASC_CHANGE",[i])}else{JC.AutoComplete.ajaxUpdate(e._model.selector(),JC.f.printf(e._model.bascAjaxUrl(),h),function(j){e.trigger("BASC_CHANGE",[i,h,j]);var k=this;if(e._model.firstUpdate()){e._model.firstUpdate(false);e.trigger("BASC_FIRST_UPDATE",[j,k]);return}e.trigger("BASC_CLEAR")})}});e.on("BASC_CLEAR",function(){var f=JC.AutoComplete.getInstance(e._model.selector());if(!f){return}f.clear()});e.on("BASC_ALL_CHANGE",function(f,h){var g=JC.AutoComplete.getInstance(e._model.selector());if(h.is(":visible")&&h.val()){if(g){e._model.selector().show()}else{e._model.selector().hide()}}else{e._model.selector().hide()}});e.on("BASC_CHANGE",function(g,j,i,f){JC.log("BASC_CHANGE",new Date().getTime(),i,f);var h=JC.AutoComplete.getInstance(e._model.selector());if(!(i&&f&&f.length)){e._model.selector().hide();JC.log("hide")}else{e._model.selector().show()}});e.on("BASC_FIRST_UPDATE",function(g,f,h){var i=h.idVal();if(!i){return}d.each(f,function(k,j){if(j.id==i){h.selector().val(j.label);return false}})})},_inited:function(){JC.log("AutoSelectComplete _inited",new Date().getTime());this._model.selector().attr("cacDataFilter",c.Model.DATA_FILTER_NAME);this._model.injectDefaultSelectCallback()}};BaseMVC.buildModel(c);c.Model._instanceName="AutoSelectComplete";c.Model.INS_COUNT=1;c.Model.DATA_FILTER_NAME="BizsAutoSelectCompleteDataFilter";c.Model.prototype={init:function(){JC.log("AutoSelectComplete.Model.init:",new Date().getTime());this._insCount=c.Model.INS_COUNT++;this._firstUpdate=true},firstUpdate:function(e){typeof e!="undefined"&&(this._firstUpdate=e);return this._firstUpdate},insCount:function(){return this._insCount},bascDefaultSelect:function(){var e=this.selectorProp("bascDefaultSelect");return e},injectDefaultSelectCallback:function(){var e=this,f=e.callbackProp(e.bascDefaultSelect(),"selectallchanged"),g="AutoSelectComplete_inject_"+e.insCount();if(e.bascDefaultSelect().attr("selectallchanged")==g){return}window[g]=function(h){if(f){f.apply(this,JC.f.sliceArgs(arguments))}d(e).trigger("TriggerEvent",["BASC_SELECT_CHANGED",h[h.length-1]])};e.bascDefaultSelect().attr("selectallchanged",g)},bascAjaxUrl:function(){var e=this.attrProp("bascAjaxUrl");return e},bascDefaultLabel:function(){var e=this.attrProp("bascDefaultLabel");return e},bascDefaultId:function(){var e=this.attrProp("bascDefaultId");return e}};BaseMVC.buildView(c);c.View.prototype={init:function(){JC.log("AutoSelectComplete.View.init:",new Date().getTime())}};BaseMVC.build(c,"Bizs");window[c.Model.DATA_FILTER_NAME]=function(e){if(e.data&&e.data.length){e=e.data}d.each(e,function(g,f){f.length&&(e[g]={id:f[0],label:f[1]})});return e};d(document).ready(function(){var e=0;c.autoInit&&(e=c.init())})}(jQuery));return Bizs.AutoSelectComplete})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
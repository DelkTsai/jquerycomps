(function(b,a){b(["JC.BaseMVC"],function(){Bizs.InputSelect=d;function d(e){e&&(e=$(e));if(JC.BaseMVC.getInstance(e,d)){return JC.BaseMVC.getInstance(e,d)}JC.BaseMVC.getInstance(e,d,this);this._model=new d.Model(e);this._view=new d.View(this._model);this._init()}d.init=function(e){var f=[];e=$(e||document);if(e.length){if(e.hasClass("js_bizInputSelect")){f.push(new d(e))}else{e.find(".js_bizInputSelect").each(function(){f.push(new d(this))})}}return f};BaseMVC.build(d);JC.f.extendObject(d.prototype,{_beforeInit:function(){var e=this;e._model.selector().addClass("IPTSEL-BOX").append('<span class="IPTSEL-ARROW"></span>')},_initHanlderEvent:function(){var e=this;e._model.selector().data("visible",0);e._model.iptselipt().on("click",function(){if(e.selector().data("visible")){e._hide()}else{return}});e._model.iptselarrow().on("click",function(f){f.stopPropagation();if(e._model.dataurl()&&!e._model.dataready){e._model.ajaxdata()}e[e._model.selector().data("visible")?"_hide":"_show"]()});e._model.iptselbox().delegate(e._model.iptseloption()[0],"click",function(g){var f=$(g.target||g.srcElement);e._model.iptselipt().val(f.data("label"));e._model.iptselhideipt().val(f.data("value"));e._hide();JC.f.safeTimeout(function(){e._model.iptselipt().trigger("blur")},null,"IptSelItemClick",200)});e._model.iptselbox().on("mousedown",function(f){f.stopPropagation()});$(document).on("mousedown",function(){e._hide()})},_inited:function(){},_show:function(){var e=this;e._view.show();e._model.selector().data("visible",1);return this},_hide:function(){var e=this;e._view.hide();e._model.selector().data("visible",0);return this}});d.Model._instanceName="InputSelectIns";JC.f.extendObject(d.Model.prototype,{init:function(){},iptselipt:function(){return JC.f.parentSelector(this.selector(),this.attrProp("iptselipt")).addClass("IPTSEL-INPUT")},iptselhideipt:function(){return JC.f.parentSelector(this.selector(),this.attrProp("iptselhideipt")).addClass("IPTSEL-HIDE")},iptselarrow:function(){return this.selector().find(".IPTSEL-ARROW")},iptseloption:function(){var e=this.selector();return JC.f.parentSelector(e,this.attrProp("iptseloption")).addClass("IPTSEL-ITEM")},iptselbox:function(){var f=this,e=f.attrProp("iptseldatabox");return JC.f.parentSelector(f.selector(),e).addClass("IPTSEL-DROPDOWN")},iptselprevententer:function(){var f,e=this.selector();e.is("[iptselprevententer]")&&(_r=JC.f.parseBool(e.attr("iptselprevententer")));return _r},dataurl:function(){return this.attrProp("iptseldataurl")},ajaxdata:function(){var f=this,e=this.dataurl();$.get(e).done(function(k){k=$.parseJSON(k);var h="<ul>",j=0,g;if(k.errorno){JC.f.alert("操作失败",2)}else{g=k.data.length;if(g===0){h="<li>暂无数据</li>"}else{for(j=0;j<g;j++){h+='<li data-label="'+k.data[j].label+'" class="IPTSEL-ITEM">'+k.data[j].label+"</li>"}}h+="</ul>";f.iptselbox().html(h);f.dataready=1}})},dataready:0});JC.f.extendObject(d.View.prototype,{init:function(){},show:function(){var e=this;e._model.iptselbox().show()},hide:function(){var e=this;e._model.iptselbox().hide()}});var c=$(document);c.ready(function(){var e=0;d.autoInit&&(e=d.init())});return Bizs.InputSelect})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
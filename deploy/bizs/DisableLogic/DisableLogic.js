(function(b,a){b(["JC.BaseMVC"],function(){(function(c){window.Bizs=window.Bizs||{};window.Bizs.DisableLogic=f;function f(g){if(f.getInstance(g)){return f.getInstance(g)}f.getInstance(g,this);JC.log("Bizs.DisableLogic:",new Date().getTime());this._model=new e(g);this._view=new d(this._model);this._init()}f.prototype={_init:function(){var g=this,h;g._initHandlerEvent();c([g._view,g._model]).on("BindEvent",function(i,k,j){g.on(k,j)});c([g._view,g._model]).on("TriggerEvent",function(i,k){var j=JC.f.sliceArgs(arguments).slice(2);g.trigger(k,j)});g._model.init();g._view.init();g._model.dltrigger().on("change",function(i){JC.log("dltrigger change",new Date().getTime());g._view.change(this)});(h=g._model.dltrigger(true))&&h.trigger("change");return g},_initHandlerEvent:function(){var g=this;g.on("DisableItem",function(i,h){g._model.dldisablecallback()&&g._model.dldisablecallback().call(g,h,g._model.selector())});g.on("EnableItem",function(i,h){g._model.dlenablecallback()&&g._model.dlenablecallback().call(g,h,g._model.selector())});g.on("ChangeDone",function(i,h){g._model.dldonecallback()&&g._model.dldonecallback().call(g,h,g._model.selector())})},selector:function(){return this._model.selector()},on:function(h,g){c(this).on(h,g);return this},trigger:function(h,g){c(this).trigger(h,g);return this}};f.getInstance=function(g,h){if(typeof g=="string"&&!/</.test(g)){g=c(g)}if(!(g&&g.length)||(typeof g=="string")){return}typeof h!="undefined"&&g.data("DisableLogicIns",h);return g.data("DisableLogicIns")};f.doneCallback=null;f.enableCallback=null;f.disableCallback=null;f.init=function(g){g=c(g||document);g.find(["div.js_bizsDisableLogic","dl.js_bizsDisableLogic","table.js_bizsDisableLogic"].join()).each(function(){new f(c(this))})};function e(g){this._selector=g}e.prototype={init:function(){return this},selector:function(){return this._selector},dltrigger:function(h){var g=this,j=JC.f.parentSelector(this.selector(),this.selector().attr("dltrigger")),i;if(h){j.each(function(){i=c(this);if(i.prop("checked")||i.prop("selected")){j=i;return false}})}return j},dltarget:function(h){var g=this,j,i;g.selector().attr("dltarget")&&(j=JC.f.parentSelector(g.selector(),g.selector().attr("dltarget")));h&&(h=c(h)).length&&h.attr("dltrigger")&&(j=JC.f.parentSelector(h,h.attr("dltarget")));return j},dldisable:function(g){var h=false;g&&(g=c(g)).length&&g.is("[dldisable]")&&(h=JC.f.parseBool(g.attr("dldisable")));if(g.prop("nodeName").toLowerCase()=="input"&&g.attr("type").toLowerCase()=="checkbox"){h=!g.prop("checked")}return h},dldisplay:function(g){var h=false;if(!g.is("[dldisplay]")){(g=c(g)).length&&g.is("[dldisable]")&&(h=!JC.f.parseBool(g.attr("dldisable")))}else{(g=c(g)).length&&g.is("[dldisplay]")&&(h=JC.f.parseBool(g.attr("dldisplay")))}if(g.prop("nodeName").toLowerCase()=="input"&&g.attr("type").toLowerCase()=="checkbox"){h=g.prop("checked")}return h},dlhidetarget:function(h){var g=this,j,i;g.selector().attr("dlhidetarget")&&(j=JC.f.parentSelector(g.selector(),g.selector().attr("dlhidetarget")));h&&(h=c(h)).length&&h.attr("dlhidetarget")&&(j=JC.f.parentSelector(h,h.attr("dlhidetarget")));return j},dlhidetoggle:function(g){var h;g&&g.is("[dlhidetoggle]")&&(h=JC.f.parseBool(g.attr("dlhidetoggle")));return h},dldonecallback:function(){var h=f.doneCallback,g;this.selector()&&(g=this.selector().attr("dldonecallback"))&&(g=window[g])&&(h=g);return h},dlenablecallback:function(){var h=f.enableCallback,g;this.selector()&&(g=this.selector().attr("dlenablecallback"))&&(g=window[g])&&(h=g);return h},dldisablecallback:function(){var h=f.disableCallback,g;this.selector()&&(g=this.selector().attr("dldisablecallback"))&&(g=window[g])&&(h=g);return h}};function d(g){this._model=g}d.prototype={init:function(){return this},change:function(h){h&&(h=c(h));if(!(h&&h.length&&h.is(":visible"))){return}var g=this,k=g._model.dldisable(h),m=g._model.dltarget(h),l=g._model.dldisplay(h),j=g._model.dlhidetarget(h);if(h.is("[dlhidetargetsub]")){var i=JC.f.parentSelector(h,h.attr("dlhidetargetsub"));if(i&&i.length){if(h.prop("checked")){i.show()}else{i.hide()}}}if(m&&m.length){m.each(function(){var o=c(this);o.attr("disabled",k);JC.Valid&&JC.Valid.setValid(o);if(o.is("[dlhidetargetsub]")){var n=JC.f.parentSelector(o,o.attr("dlhidetargetsub"));if(!(n&&n.length)){return}if(k){n.hide()}else{if(o.prop("checked")){n.show()}else{n.hide()}}}})}if(j&&j.length){j.each(function(){var n=g._model.dlhidetoggle(c(this))?!l:l;n?c(this).show():c(this).hide()})}k?c(g).trigger("TriggerEvent",["DisableItem",h]):c(g).trigger("TriggerEvent",["EnableItem",h]);c(g).trigger("TriggerEvent",["ChangeDone",h]);JC.log("DisableLogic view change",new Date().getTime(),k)}};c(document).ready(function(){setTimeout(function(){f.init()},10)})}(jQuery));return Bizs.DisableLogic})}(typeof define==="function"&&define.amd?define:function(a,b){b&&b()},this));
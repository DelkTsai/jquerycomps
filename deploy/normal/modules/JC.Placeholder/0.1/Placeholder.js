(function(e,t){e(["JC.BaseMVC"],function(){return function(e){function t(n){n&&(n=e(n));if(t.isSupport){n&&n.is("[xplaceholder]")&&n.attr("placeholder",n.attr("xplaceholder"));return}if(t.getInstance(n))return t.getInstance(n);t.getInstance(n,this),this._model=new t.Model(n),this._view=new t.View(this._model),this._init(),JC.log("Placeholder:",(new Date).getTime())}function n(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange(),r=t,i=t,s=0,o=0,u=e.value;for(var a=0;a<u.length&&a<r;a++){var f=u.charAt(a);f!="\n"&&s++}for(var a=u.length-1;a>=i&&a>=0;a--){var f=u.charAt(a);f!="\n"&&o++}n.moveStart("character",s),n.moveEnd("character",-o),n.select(),e.focus()}}window.JC=window.JC||{log:function(){}},JC.Placeholder=t,t.getInstance=function(n,r){typeof n=="string"&&!/</.test(n)&&(n=e(n));if(!n||!n.length||typeof n=="string")return;return typeof r!="undefined"&&n.data(t.Model._instanceName,r),n.data(t.Model._instanceName)},t.init=function(n){var r=[],i;return t.update(),n=e(n||document),n&&n.length&&(i=n.prop("nodeName").toLowerCase())&&(i=="text"||i=="textarea"?t.isSupport?n.is("[xplaceholder]")&&n.attr("placeholder",n.attr("xplaceholder")):n.is("[placeholder]")&&r.push(new t(n)):n.find(["input[type=text][placeholder]","textarea[placeholder]","input[type=text][xplaceholder]","textarea[xplaceholder]"].join(",")).each(function(){var n=e(this);t.isSupport?n.is("[xplaceholder]")&&n.attr("placeholder",n.attr("xplaceholder")):r.push(new t(n))})),r},t.update=function(){var n=e(JC.f.printf("#{0} > div",t.Model._boxId));if(!n.length)return;n.each(function(){var t=e(this),n=t.data("CPHIns");if(!n)return;n.update()})},t.className="xplaceholder",t.isSupport="placeholder"in e('<input type="text" />')[0],t.prototype={_beforeInit:function(){},_initHanlderEvent:function(){var e=this;e._model.selector().on("focus",function(t){e._view.hide()}),e._model.selector().on("blur",function(t){e._view.show()}),e._model.selector().on("placeholder_remove",function(n){e._model.placeholder().remove(),t.Model._removeTm&&clearTimeout(t.Model._removeTm),t.Model._removeTm=setTimeout(function(){t.update()},1)}),e.on("CPHUpdate",function(t){e._view.update()}),e.on("CPHInitedPlaceholder",function(t){var r=e._model.placeholder();r.on("click",function(t){e._model.selector().trigger("focus"),n(e._model.selector()[0],e._model.selector().val().length)}),r.data("CPHIns",e)})},_inited:function(){var t=e(this);t.trigger("CPHUpdate")},update:function(){this._view.update()}},BaseMVC.buildModel(t),t.Model._instanceName="Placeholder",t.Model._boxId="XPlaceHolderBox",t.Model.prototype={init:function(){},className:function(){var e=this.attrProp("cphClassName")||t.className;return e},text:function(){var e=this.attrProp("xplaceholder")||this.attrProp("placeholder")||"";return e},placeholder:function(){return this._placeholder||(this._placeholder=e(JC.f.printf('<div class="{0}"></div>',this.className())).appendTo(this.placeholderBox()),e(this).trigger("TriggerEvent",["CPHInitedPlaceholder"])),this._placeholder.html(this.text()),this._placeholder},placeholderBox:function(){var n=e("#"+t.Model._boxId);if(!n||!n.length)n=e(JC.f.printf('<div id="{0}"></div>',t.Model._boxId)).appendTo(document.body);return n}},BaseMVC.buildView(t),t.View.prototype={init:function(){},update:function(){var e=this,t=e._model.selector().val().trim(),n=e._model.placeholder();if(t){n.hide();return}var r=e._model.selector().offset(),i=e._model.selector().prop("offsetHeight"),s=n.prop("offsetHeight");n.css({left:r.left+"px",top:r.top+1+"px","line-height":i+"px"}),n.show()},hide:function(){var e=this;e._model.placeholder().hide()},show:function(){var e=this,t=e._model.selector().val().trim();if(t)return;this.update(),e._model.placeholder().show()}},BaseMVC.build(t),e.event.special.placeholder_remove={remove:function(e){e.handler&&e.handler()}},e(window).on("resize",function(){t.update()});var r=e.fn.show,i=e.fn.hide,s=e({});e.fn.show=function(){var e=r.apply(this,arguments),t=this;return setTimeout(function(){s.trigger("show")},1),e},e.fn.hide=function(){var e=i.apply(this,arguments),t=this;return setTimeout(function(){s.trigger("hide")},1),e},s.on("show hide",function(){s.data("timer")&&clearTimeout(s.data("timer")),s.data("timer",setTimeout(function(){t.update()},100))}),e(document).ready(function(){var e=0;t.autoInit&&(e=t.init())})}(jQuery),JC.Placeholder})})(typeof define=="function"&&define.amd?define:function(e,t,n){typeof e=="function"&&(n=e),typeof t=="function"&&(n=t),n&&n()},window);
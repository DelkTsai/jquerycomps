(function(e,t){e(["JC.BaseMVC"],function(){function e(t){t&&(t=$(t));if(e.getInstance(t))return e.getInstance(t);e.getInstance(t,this),this._model=new e.Model(t),this._view=new e.View(this._model),this._init()}return JC.Paginator=e,e.getInstance=function(t,n){typeof t=="string"&&!/</.test(t)&&(t=$(t));if(!t||!t.length||typeof t=="string")return;return typeof n!="undefined"&&t.data(e.Model._instanceName,n),t.data(e.Model._instanceName)},e.init=function(t){var n=[];return t=$(t||document),t.length&&(t.hasClass("js_compPaginator")?n.push(new e(t)):t.find(".js_compPaginator").each(function(){n.push(new e(this))})),n},BaseMVC.build(e),JC.f.extendObject(e.prototype,{_beforeInit:function(){},_initHanlderEvent:function(){var e=this,t=e._model.selector();if(!e._model.totalRecords())return;e._model.requestUrl=e._model.url(),e._view.paginatedView(),e._model.needInit()&&e._model.fetch(),t.delegate(".js_page","click",function(t){t.preventDefault();var n=$(this);e.trigger("GOTOPAGE",[n.text(),n])}).delegate(".js_prevpage","click",function(t){t.preventDefault(),e.trigger("PREVPAGE")}).delegate(".js_nextpage","click",function(t){t.preventDefault(),e.trigger("NEXTPAGE")}).delegate(".js_perpage","change",function(t){e._model.currentPage=1,e.trigger("UPDATEVIEW",[$(this).val()])}),e.on("RENDER",function(t,n){e._view.contentView(n)}),e.on("RENDERSTATIC",function(t){e._view.staticContentView()}),e.on("PREVPAGE",function(){e._model.prevPage()}),e.on("NEXTPAGE",function(){e._model.nextPage()}),e.on("GOTOPAGE",function(t,n,r){e._model.gotoPage(n)}),e.on("UPDATEVIEW",function(t,n){e._view.paginatedView(n),e._model.selector().attr("perPage",n),e._model.fetch(n)}),e.on("FLIPPED",function(t,n){e._model.flipped()&&e._model.flipped().call(e,e.selector(),n)})},_inited:function(){}}),e.Model._instanceName="Paginator",JC.f.extendObject(e.Model.prototype,{needInit:function(){return this.boolProp("needInit")},paginatortype:function(){return this.attrProp("paginatortype")||"ajax"},paginatorUi:function(){var e=this,t=e.attrProp("paginatorui")||".page";return e.selector().find(t)},paginatorContent:function(){var e=this,t=e.attrProp("paginatorcontent")||".content";return e.selector().find(t)},paginatorContentTpl:function(){return JC.f.scriptContent(this.attrProp("paginatorContentTpl"))},paginatorUiTpl:function(){return JC.f.scriptContent(this.attrProp("paginatorUiTpl"))},url:function(){return this.attrProp("paginatorurl")},requestUrl:"",currentPage:1,perPage:function(){return this.intProp("perPage")||10},maxPage:function(){return this.intProp("maxPage")||10},totalRecords:function(){return this.intProp("totalrecords")},gotoPage:function(e){this.currentPage=parseInt(e,10),this.fetch()},prevPage:function(){var e=this;if(e.currentPage===1)return;e.currentPage--,e.fetch()},nextPage:function(){var e=this,t=Math.ceil(e.totalRecords()/e.perPage());if(e.currentPage===t)return;e.currentPage++,e.fetch()},fetch:function(){var e=this,t=e.currentPage,n=e.perPage(),r=JC.f.printf(e.requestUrl,n,t);e.paginatortype()==="static"?setTimeout(function(){e.trigger("RENDERSTATIC")},10):$.ajax({type:"POST",url:r,success:function(t){t=$.parseJSON(t),t.errorno||t.data.html&&e.trigger("RENDER",[t.data.html])}})},flipped:function(){var e=this,t=e.selector(),n="flipped";return e.callbackProp(t,n)}}),JC.f.extendObject(e.View.prototype,{init:function(){},paginatedView:function(e){var t=this,n=t._model.paginatorUi(),r=t._model.paginatorUiTpl(),e=e||t._model.perPage(),i=Math.ceil(t._model.totalRecords()/e),s=t._model.maxPage(),o="",u;for(u=1;u<=i;u++)o+='<a href="#" class="js_page">'+u+"</a>";r=JC.f.printf(r,i,t._model.totalRecords(),o),n.html(r).find(".js_perpage").val(e),!t._model.needInit()&&t.updateView()},contentView:function(e){var t=this,n=t._model.paginatorContent();n.html(e),t.updateView(),t.trigger("FLIPPED",[e])},staticContentView:function(){var e=this,t=e._model.currentPage,n=e._model.perPage(),r=Math.ceil(e._model.totalRecords/n),i=1;e._model.paginatorContent().find("tr").each(function(e){e>0&&e%n===0&&i++,$(this)[i===t?"show":"hide"]()}),e.updateView(),e.trigger("FLIPPED")},updatePaginatorView:function(e,t){var n=this,r=n._model.maxPage(),i=Math.ceil(n._model.totalRecords()/n._model.perPage()),s="";t=parseInt(t,10);if(n._model.currentPage+(r-1)>=i)return;t>1&&(s='<a href="#" class="js_page">'+(n._model.currentPage+(r-1))+"</a>"),e.next().after(s)},updateView:function(){var e=this,t=e._model.paginatorUi(),n=e._model.paginatorContent(),r=e._model.currentPage,i=Math.ceil(e._model.totalRecords()/e._model.perPage());r===1?t.find(".js_prevpage").prop("disabled",!0).addClass("disabled"):t.find(".js_prevpage").prop("disabled",!1).removeClass("disabled"),r===i?t.find(".js_nextpage").prop("disabled",!0).addClass("disabled"):t.find(".js_nextpage").prop("disabled",!1).removeClass("disabled"),t.find(".js_page").each(function(){var e=$(this);parseInt(e.text(),10)===r&&e.addClass("cur").siblings(".js_page").removeClass("cur")})}}),$(document).ready(function(){var t=0;e.autoInit&&(t=e.init())}),JC.Paginator})})(typeof define=="function"&&define.amd?define:function(e,t,n){typeof e=="function"&&(n=e),typeof t=="function"&&(n=t),n&&n()},window);
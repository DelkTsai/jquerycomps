(function(define,_win){define(["Raphael","JC.BaseMVC","JC.PopTips"],function(){var _jdoc=$(document),_jwin=$(window);var isIE=!!window.ActiveXObject;JC.FlowChart=FlowChart;if(JC.use){!window.Raphael&&(JC.use("plugins.raphael"));!JC.PopTips&&(JC.use("JC.PopTips"))}function FlowChart(_selector){_selector&&(_selector=$(_selector));if(JC.BaseMVC.getInstance(_selector,FlowChart)){return JC.BaseMVC.getInstance(_selector,FlowChart)}JC.BaseMVC.getInstance(_selector,FlowChart,this);this._model=new FlowChart.Model(_selector);this._view=new FlowChart.View(this._model);this._init()}FlowChart.init=function(_selector){var _r=[];_selector=$(_selector||document);if(_selector.length){if(_selector.hasClass("js_compFlowChart")){_r.push(new FlowChart(_selector))}else{_selector.find("div.js_compFlowChart").each(function(){_r.push(new FlowChart(this))})}}return _r};JC.BaseMVC.build(FlowChart);JC.f.extendObject(FlowChart.prototype,{_beforeInit:function(){},_initHanlderEvent:function(){var _p=this;_p.on("inited",function(){if(!_p._model.chartData()){return}_p._view.draw();_p.notification(JC.FlowChart.Model.INITED,[_p,_p._model.data()])})},_inited:function(){this.trigger("inited")}});FlowChart.Model._instanceName="JCFlowChart";FlowChart.Model.INITED="cfc_inited";FlowChart.Model.ITEM_INITED="cfc_nodeInited";FlowChart.Model.BEFORE_INIT_ITEM="cfc_beforeInitItem";JC.f.extendObject(FlowChart.Model.prototype,{init:function(){},data:function(){if(typeof this._data=="undefined"&&this.is("[data-FlowChart]")){this._data=eval("("+this.scriptTplProp("data-FlowChart")+")")}return this._data},chartData:function(){return this.data().chart},colorsData:function(){return this.data().colors},initGrid:function(){var _p=this;_p._grid={data:[],idColumnIndex:{},idColumnIndexList:[],row:{},idMap:{},columnIndexMap:{},maxColumn:0,rowIndexPad:0,offsetRowIndex:10000};_p.initIdColumnIndex(_p.chartData(),_p.chartData().id,0,0,0);_p.initColumnIndexMap();_p.initColumnRelationship();_p.fixLastColumn();_p.initColumnRelationship();_p.initRowIndex();_p.fixNodesRowIndex();_p.fixTargetNodesRowIndex();_p.fixRealRowIndex();_p.fixFirstLastRowIndex();_p.createItems();_p.calcRealPosition();JC.dir(_p.gridIdColumnIndexMap())},fixLastColumn:function(){var _p=this,_max=_p.gridMaxColumn(),_list;if(_max<1){return}_list=_p.gridIdColumnIndexMap()[_max];if(_list.length<2){return}for(var i=_list.length-1;i>=0;i--){var _item=_list[i];if(!(_item.nodes&&_item.nodes.length)&&(_item.pid&&_item.pid.length>1)){_list.splice(i,1);_item.columnIndex=_max+1;_p.gridMaxColumn(_item.columnIndex);_p.gridIdColumnIndexMap()[_p.gridMaxColumn()]=[_item];break}}},grid:function(){return this._grid},gridIdColumnIndex:function(){return this.grid().idColumnIndex},gridIdColumnIndexList:function(){return this.grid().idColumnIndexList},gridIdColumnIndexMap:function(){return this.grid().columnIndexMap},gridRow:function(){return this.grid().row},gridIdMap:function(_id){if(typeof _id!="undefined"){return this.grid().idMap[_id]}return this.grid().idMap},gridOffsetRowIndex:function(){return this.grid().offsetRowIndex},gridHeight:function(){return 40},gridWidth:function(){return 120},lineWidth:function(){return 75},childLineWidth:function(){return 40},parentLineWidth:function(){return 25},itemHtmlPattern:function(_item){var _r="{0}";("tipsHtml" in _item)&&_item.tipsHtml&&(_r=this.tipsTpl());return _r},tipsTpl:function(){if(!this._tipsTpl){this._tipsTpl=FlowChart.TIPS_TPL;this._tipsTpl=this.scriptTplProp("cfcTipsTpl")||this._tipsTpl}return this._tipsTpl},createItems:function(){var _p=this,_sx=0,_sy=0;_p._items={};_p._columnWidth=[];for(var i=0;i<=_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i],_maxWidth=_p.gridWidth();$.each(_rowList,function(_k,_item){var _html,_itemHtmlPatter;_p.notification(JC.FlowChart.Model.BEFORE_INIT_ITEM,[_item,_rowList,_p.data()]);_html=JC.f.printf('<div class=" ">{0}</div>',_item.name,_p.getStatus(_item));_itemHtmlPatter=JC.f.printf(_p.itemHtmlPattern(_item),_html,_item.tipsHtml,_p.getStatus(_item));var _node=$(_itemHtmlPatter),_tmpWidth;_node.addClass(JC.f.printf("js_cfcItem js_cfcItemStatus_{0}",_p.getStatus(_item)));_node.css({position:"absolute"});_node.appendTo(_p.box());_node.data("nodeData",_item);_p._items[_item.id]=_node;_tmpWidth=_node.width();_tmpWidth>_maxWidth&&(_maxWidth=_tmpWidth)});if(i===0){_maxWidth=Math.ceil(_p._items[_p.chartData().id].width()+30)}_p._columnWidth.push(_maxWidth)}},getStatus:function(_itemData){var _r=0;("status" in _itemData)&&(_r=_itemData.status);return _r},calcRealPosition:function(){var _p=this,_sx=0,_sy=0,_countX=0;_p._columnX=[];_p._minX=_sx;_p._maxX=0;_p._minY=0;_p._maxY=0;for(var i=0;i<=_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i];$.each(_rowList,function(_k,_item){var _x=_sx,_y=_sy;_x+=_countX;_y+=_item.rowIndex*_p.gridHeight();_y<_p._minY&&(_p._minY=_y);(_y+_p.gridHeight()/2)>_p._maxY&&(_p._maxY=(_y+_p.gridHeight()/2));_item.x=_x;_item.y=_y});_p._maxX=_sx+_countX+_p.columnWidth(i);_p._columnX.push(_sx+_countX);_countX+=Math.max(_p.gridWidth(),_p.columnWidth(i))+_p.lineWidth();if(_p.listHasChildline(_rowList)){_countX+=_p.childLineWidth()}if(_p.listHasParentline(_rowList)){_countX+=_p.parentLineWidth()}}},minX:function(){return this._minX},minY:function(){return this._minY},maxX:function(){return this._maxX},maxY:function(){return this._maxY},items:function(){return this._items},item:function(_id){return this._items[_id]},columnWidth:function(_ix){if(typeof _ix!=undefined){return this._columnWidth[_ix]||0}return this._columnWidth},columnX:function(_ix){if(typeof _ix!=undefined){return this._columnX[_ix]||0}return this._columnX},fixFirstLastRowIndex:function(){var _p=this;_p._maxRowY=0;if(_p.gridMaxColumn()<2){return}for(var i=0;i<_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i];$.each(_rowList,function(_k,_item){_item.rowIndex>_p._maxRowY&&(_p._maxRowY=_item.rowIndex)})}var _fcol=_p.gridIdColumnIndexMap()[0],_first,_last,_lcol=_p.gridIdColumnIndexMap()[_p.gridMaxColumn()-1];if(_fcol&&_fcol.length){var _fdata=_fcol[0];if(_fdata.nodes&&_fdata.nodes.length){_first=_fdata.nodes.first();_last=_fdata.nodes.last();_fdata.rowIndex=_first.rowIndex+(_last.rowIndex-_first.rowIndex)/2}}},fixNodesRowIndex:function(){var _p=this;for(var i=0;i<=_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i],_nextList=_p.gridIdColumnIndexMap()[i+1];$.each(_rowList,function(_k,_item){var _preItem=_rowList[_k-1],_nextItem=_rowList[_k+1],_oldIx=_item.rowIndex,_nodes=_item.nodes,_pid=_item.pid,_pitem=_p.gridIdMap(_pid)||{},_fdata,_ldata,_fitem,_litem,_midY,_spaceY,_minY,_maxY;if(_nodes&&_nodes.length){if(_nodes.length>1){_fdata=_nodes.first();_ldata=_nodes.last();_midY=_fdata.rowIndex+(_ldata.rowIndex-_fdata.rowIndex)/2;_spaceY=_oldIx-_midY;_minY=_fdata.rowIndex+_spaceY;_maxY=_ldata.rowIndex+_spaceY;if(_spaceY===0){return}if(_fdata.prev&&_minY<=_fdata.prev.rowIndex){_spaceY=_fdata.prev.rowIndex+1-_minY;_minY+=_spaceY;_maxY+=_spaceY;_p.fixItemDataAndNext(_fdata,_minY-_fdata.rowIndex);_p.fixItemDataAndNext(_item,_spaceY);_p.fixItemParentDataAndNext(_item,_spaceY)}else{if(_ldata.next&&_maxY>=_ldata.next.rowIndex){_p.fixItemDataAndNext(_fdata,_maxY-_ldata.rowIndex)}else{_p.fixItemDataAndNext(_fdata,_spaceY)}}}else{_fdata=_nodes.first();if(_item.rowIndex===_fdata.rowIndex){return}_maxY=Math.max(_item.rowIndex,_fdata.rowIndex);if(_item.rowIndex>_fdata.rowIndex){_p.fixItemDataAndNext(_fdata,_item.rowIndex-_fdata.rowIndex)}else{if(_item.rowIndex<_fdata.rowIndex){_p.fixItemDataAndNext(_item,_fdata.rowIndex-_item.rowIndex);var _newIx=_item.rowIndex;_p.fixItemParentDataAndNext(_item,_newIx-_oldIx)}else{}}}}})}},fixTargetNodesRowIndex:function(){var _p=this;for(var i=0;i<=_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i],_nextList=_p.gridIdColumnIndexMap()[i+1];$.each(_rowList,function(_k,_item){var _preItem=_rowList[_k-1],_nextItem=_rowList[_k+1],_oldIx=_item.rowIndex,_nodes=_item.nodes,_pid=_item.pid,_fdata,_ldata,_fitem,_litem,_midY,_spaceY,_minY,_maxY;if(_pid&&_pid.length){if(_pid.length>1){_fdata=_p.gridIdMap(_pid.first());_ldata=_p.gridIdMap(_pid.last());_midY=_fdata.rowIndex+(_ldata.rowIndex-_fdata.rowIndex)/2;if(_item.prev&&_item.prev.rowIndex>=_midY){}else{if(_item.next&&_item.next.rowIndex<=_midY){_p.fixItemDataAndNext(_item,_midY-_item.rowIndex)}else{_spaceY=_midY-_item.rowIndex;_item.rowIndex=_midY;_p.fixItemChildDataAndNext(_item,_spaceY)}}}else{_fdata=_p.gridIdMap(_pid.first());if(_fdata.targetNode){if(_item.next&&_fdata.rowIndex>=_item.next.rowIndex){_spaceY=_fdata.rowIndex-_item.rowIndex;_p.fixItemDataAndNext(_item,_spaceY)}else{_spaceY=_fdata.rowIndex-_item.rowIndex;_item.rowIndex=_fdata.rowIndex;_p.fixItemChildDataAndNext(_item,_spaceY)}}}}})}},fixItemChildDataAndNext:function(_item,_spaceY){var _p=this,_nextSpaceY,_newIx;if(!(_item&&_item.nodes&&_item.nodes.length)){return}$.each(_item.nodes,function(_k,_sitem){_sitem.rowIndex+=_spaceY;_p.fixItemChildDataAndNext(_sitem,_spaceY)})},fixItemParentDataAndNext:function(_item,_spaceY,_isRealY){var _p=this,_nextSpaceY,_newIx;if(!(_item&&_item.pid&&_item.pid.length)){return}var _pitem=_p.gridIdMap(_item.pid.first()),_fdata,_ldata,_midY;if(!(_pitem)){return}_p.fixItemDataAndNext(_pitem,_spaceY);_p.fixItemParentDataAndNext(_pitem,_spaceY,_isRealY)},fixItemDataAndNext:function(_node,_spaceY){while(_node){_node.rowIndex+=_spaceY;_node=_node.next}},fixRealRowIndex:function(){var _p=this,_sx=0,_sy=0,_minY=0;for(var i=0;i<=_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i];$.each(_rowList,function(_k,_item){var _rowIx=_item.rowIndex-_p.gridOffsetRowIndex();_item.rowIndex=_rowIx;_rowIx<_minY&&(_minY=_rowIx)})}if(_minY<0){_minY=Math.abs(_minY);for(var i=0;i<=_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i];$.each(_rowList,function(_k,_item){_item.rowIndex+=_minY})}}},initRowIndex:function(){var _p=this;for(var i=0;i<=_p.gridMaxColumn();i++){var _rowList=_p.gridIdColumnIndexMap()[i],_preList=_p.gridIdColumnIndexMap()[i-1],_len=_rowList.length,_preLen=_preList?_preList.length:0;_preList&&(_preList=_preList.slice().reverse());if(i===0){$.each(_rowList,function(_k,_item){_item.rowIndex=_p.gridOffsetRowIndex()});continue}var _minRowIndex=_p.gridOffsetRowIndex(),_maxRowIndex=_p.gridOffsetRowIndex(),_itemIndexLen=1,_startIndex=_p.gridOffsetRowIndex();if(_rowList.length>1){_itemIndexLen=_rowList.length*2}_startIndex=_startIndex-(_itemIndexLen/2);_startIndex+=1;$.each(_rowList,function(_k,_item){_item.rowIndex=_startIndex+_k*2})}},gridMaxColumn:function(_setter){typeof _setter!="undefined"&&(this.grid().maxColumn=_setter);return this.grid().maxColumn},gridRowIndexPad:function(_setter){typeof _setter!="undefined"&&(this.grid().rowIndexPad=_setter);return this.grid().rowIndexPad},initColumnIndexMap:function(){var _p=this;$.each(_p.gridIdColumnIndexList(),function(_k,_item){if(_item.columnIndex in _p.gridIdColumnIndexMap()){_p.gridIdColumnIndexMap()[_item.columnIndex].push(_item)}else{_p.gridIdColumnIndexMap()[_item.columnIndex]=[_item]}})},initColumnRelationship:function(){var _p=this;$.each(_p.gridIdColumnIndexMap(),function(_ix,_list){$.each(_list,function(_k,_item){var _prev=_list[_k-1];_item.prev=_prev;_prev&&(_prev.next=_item);_item.next=null})})},initIdColumnIndex:function(_data,_id,_ix,_processSelf,_count){var _p=this,_childIx=_ix+1,_targetNodeIx=_childIx+1;if(("columnIndex" in _data)&&_ix<_data.columnIndex){_ix=_data.columnIndex}if(!(_id in _p.gridIdMap())){_p.gridIdColumnIndexList().push(_data)}_data.id=_id;_data.pid=_data.pid||[];_data.columnIndex=_ix;_p.gridIdColumnIndex()[_id]=_data;_p.gridIdMap()[_id]=_data;_data.zindex=_count++;_ix>_p.gridMaxColumn()&&_p.gridMaxColumn(_ix);if(_data.nodes&&_data.nodes.length){var _targetNodes={};$.each(_data.nodes,function(_k,_item){_item.pid=_item.pid||[];_item.pid.push(_id);if(("targetNode" in _item)&&_p.chartData().targetNodes&&(_item.targetNode in _p.chartData().targetNodes)){_targetNodes[_item.targetNode]=_item.targetNode;_p.chartData().targetNodes[_item.targetNode].pid=_p.chartData().targetNodes[_item.targetNode].pid||[];_p.chartData().targetNodes[_item.targetNode].pid.push(_item.id)}_p.initIdColumnIndex(_item,_item.id,_childIx,false,_count)});$.each(_targetNodes,function(_k,_item){_p.initIdColumnIndex(_p.chartData().targetNodes[_k],_k,_targetNodeIx,true,_count)})}if(_processSelf&&("targetNode" in _data)&&_p.chartData().targetNodes&&(_data.targetNode in _p.chartData().targetNodes)){_p.chartData().targetNodes[_data.targetNode].pid=_p.chartData().targetNodes[_data.targetNode].pid||[];_p.chartData().targetNodes[_data.targetNode].pid.push(_id);_p.initIdColumnIndex(_p.chartData().targetNodes[_data.targetNode],_data.targetNode,_childIx,true,_count)}},buildLayout:function(){var _p=this;_p._container=$('<div class="js_cfcContainer"></div>');_p._layout=$('<div class="js_cfcLayout"></div>');_p._raphaelPlaceholder=$('<div class="js_cfcRaphael" style="position: absolute;"></div>');_p._box=$('<div class="js_cfcBox" style=""></div>');_p._raphaelPlaceholder.appendTo(_p._layout);_p._box.appendTo(_p._layout);_p._layout.appendTo(_p._container);_p._container.appendTo(_p.selector())},layout:function(){return this._layout},box:function(){return this._box},raphaelPlaceholder:function(){return this._raphaelPlaceholder},width:function(){return Math.abs(this._maxX-this._minX)},height:function(){return Math.abs(this._maxY-this._minY+5)},listHasChildline:function(_list){var _r=false;$.each(_list,function(_k,_item){if((_item.nodes&&_item.nodes.length>1)){_r=true;return false}});return _r},listHasParentline:function(_list){var _r=false,_tmp={};$.each(_list,function(_k,_item){if(_item.targetNode in _tmp){_r=true;return false}if(_item.targetNode&&!(_item.targetNode in _tmp)){_tmp[_item.targetNode]=1}});return _r},colors:function(){var _p=this;if(!_p._colors){_p._colors=_p._buildInColors;if(_p.colorsData()){$.each(_p.colorsData(),function(_k,_item){if(_k in _p._colors){if($.isPlainObject(_item)){JC.f.extendObject(_p._colors[_k],_item)}}else{_p._colors[_k]=_item}})}}return _p._colors},_buildInColors:{line:{stroke:"#E1E1E1","stroke-width":2},icon:{stroke:"#E1E1E1","stroke-width":2,fill:"#F2F2F2"}}});JC.f.extendObject(FlowChart.View.prototype,{init:function(){},draw:function(){var _p=this,_st,_et;if(!(_p._model.chartData()&&_p._model.chartData().name)){return}_st=JC.f.ts();_p._model.buildLayout();_p._model.initGrid();_p._model.layout().css({height:Math.abs(_p._model.maxY())+"px"});_p.showGrid();_p.showLine();JC.PopTips.init(_p.selector());_et=JC.f.ts()},showLine:function(){var _p=this,_rh,_raphael,_y=Math.abs(_p._model.minY()),_ypad=0;_rh=_raphael=Raphael(_p._model.raphaelPlaceholder()[0],_p._model.width(),_p._model.height());!isIE&&(_ypad=1);for(var i=0;i<=_p._model.gridMaxColumn();i++){var _rowList=_p._model.gridIdColumnIndexMap()[i],_hasChildline=_p._model.listHasChildline(_rowList),_hasParentline=_p._model.listHasParentline(_rowList),_columnX=_p._model.columnX(i),_preColumnX=_p._model.columnX(i-1),_columnWidth=_p._model.columnWidth(i),_preColumnWidth=_p._model.columnWidth(i-1),_startX=_columnX+_columnWidth,_realStartX,_lineWidth=_p._model.lineWidth(),_xpad=0;if(_hasParentline){_lineWidth+=_p._model.childLineWidth()}if(_hasChildline){_lineWidth+=_p._model.parentLineWidth()}$.each(_rowList,function(_k,_item){var _node=_p._model.item(_item.id),_pid=_item.pid,_nodes=_item.nodes,_subitem,_realStartX,_realY,_fitem,_litem,_fnode,_lnode,_ex,_sx,_sy,_ey,_tmpX,_midY,_tmpY,_tmpY1,_tmpY2,_endX,_sdata,_snode,_path;if(!(_pid||_nodes)){return}if(_pid&&_pid.length){_fitem=_p._model.gridIdMap(_pid.first());_fnode=_p._model.item(_fitem.id);if(_pid.length>1){_realStartX=_preColumnX+_preColumnWidth+_p._model.parentLineWidth();_litem=_p._model.gridIdMap(_pid.last());_lnode=_p._model.item(_litem.id);_midY=_item.y+Math.abs(_p._model.minY())+_node.outerHeight()/2+_ypad;_tmpY1=_fitem.y+Math.abs(_p._model.minY())+_fnode.outerHeight()/2+_ypad;_tmpY2=_litem.y+Math.abs(_p._model.minY())+_lnode.outerHeight()/2+_ypad;_endX=_item.x-18;_rh.path(JC.f.printf("{0}M{1} {2}L{3} {4}M{5} {6}L{7} {8}","",_realStartX,_tmpY1,_realStartX,_tmpY2,_realStartX,_midY,_endX,_midY)).attr(_p._model.colors().line);$.each(_pid,function(_sk,_sitem){_sdata=_p._model.gridIdMap(_sitem);_snode=_p._model.item(_sdata.id);_tmpY=_sdata.y+Math.abs(_p._model.minY())+_snode.outerHeight()/2+_ypad;_rh.path(JC.f.printf("{0}M{1} {2}L{3} {4}","",_sdata.x,_tmpY,_realStartX,_tmpY)).attr(_p._model.colors().line)});_rh.JCTriangle(16,_endX,_midY,_p._model.colors().icon)}else{if(_fitem&&_pid.length===1&&("targetNode" in _fitem)){_realStartX=_preColumnX+_fnode.outerWidth();_realY=_fitem.y+_fnode.outerHeight()/2;_item.y=_fitem.y;_rh.path(JC.f.printf("{0}M{1} {2}L{3} {4}","",_realStartX,_realY+_ypad,_item.x-18,_realY+_ypad)).attr(_p._model.colors().line);_rh.JCTriangle(16,_item.x-18,_realY+_ypad,_p._model.colors().icon)}}}if(_nodes&&_nodes.length){if(_nodes.length>1){_sx=_item.x+_node.outerWidth();_fitem=_nodes.first();_litem=_nodes.last();_fnode=_p._model.item(_fitem.id);_lnode=_p._model.item(_litem.id);_ex=_fitem.x;_realStartX=_ex-_p._model.childLineWidth();_midY=_item.y+Math.abs(_p._model.minY())+_node.outerHeight()/2+_ypad;_rh.path(JC.f.printf("{0}M{1} {2}L{3} {4}","",_sx,_midY,_realStartX-18,_midY)).attr(_p._model.colors().line);_rh.JCTriangle(16,_realStartX-18,_midY,_p._model.colors().icon);_tmpY1=_fitem.y+Math.abs(_p._model.minY())+_fnode.outerHeight()/2+_ypad;_tmpY2=_litem.y+Math.abs(_p._model.minY())+_lnode.outerHeight()/2+_ypad;_endX=_item.x-18;_rh.path(JC.f.printf("{0}M{1} {2}L{3} {4}","",_realStartX,_tmpY1,_realStartX,_tmpY2)).attr(_p._model.colors().line);$.each(_nodes,function(_sk,_sitem){_sdata=_sitem;_snode=_p._model.item(_sdata.id);_tmpY=_sdata.y+Math.abs(_p._model.minY())+_snode.outerHeight()/2+_ypad;_rh.path(JC.f.printf("{0}M{1} {2}L{3} {4}","",_realStartX,_tmpY,_sdata.x,_tmpY)).attr(_p._model.colors().line)})}if(_nodes.length===1){_realStartX=_columnX+_node.outerWidth();_realY=_item.y+_node.outerHeight()/2;_subitem=_nodes[0];_rh.path(JC.f.printf("{0}M{1} {2}L{3} {4}","",_realStartX,_realY+_y+_ypad,_subitem.x-18,_realY+_y+_ypad)).attr(_p._model.colors().line);_rh.JCTriangle(16,_subitem.x-18,_realY+_y+_ypad,_p._model.colors().icon)}}})}},showGrid:function(){var _p=this;for(var i=0;i<=_p._model.gridMaxColumn();i++){var _rowList=_p._model.gridIdColumnIndexMap()[i];$.each(_rowList,function(_k,_item){var _node=_p._model.item(_item.id);_node.css({left:_item.x+"px",top:_item.y+"px"});_p.notification(JC.FlowChart.Model.ITEM_INITED,[_node,_item,_rowList,_p._model.data()])})}}});FlowChart.TIPS_TPL=['<span class="js_compPopTips" style="display:inline-block;"','htmlContent="|script"','theme="white"','arrowposition="bottom"','triggerType="hover"','popTipsMinWidth="100"','popTipsMinHeight="50"',">","<span>{0}</span>",'<script type="text/template"><div class="js_cfcItemTips js_cfcItemTips_{2}">{1}</div><\/script>',"</span>"].join("");function distanceAngleToPoint(_distance,_angle){var _radian=_angle*Math.PI/180;return{x:(Math.cos(_radian)*_distance),y:(Math.sin(_radian)*_distance)}}_jdoc.ready(function(){Raphael.fn.JCTriangle=function(_sideLength,_x,_y,_params,_offsetAngle){!_sideLength&&(_sideLength=16);!_x&&(_x=0);!_y&&(_y=_sideLength/2);_y+=1;typeof _offsetAngle=="undefined"&&(_offsetAngle=180);var _p1=distanceAngleToPoint(_sideLength,330),_p2=distanceAngleToPoint(_sideLength,30),_p3=distanceAngleToPoint(_sideLength,120);_p1.x=parseInt(_p1.x+_x);_p1.y=parseInt(_p1.y+_y);_p2.x=parseInt(_p2.x+_x);_p2.y=parseInt(_p2.y+_y);var _r=this.path(JC.f.printf("{0}M{1} {2}L{3} {4}L{5} {6}L{1} {2}Z","",_x,_y,_p1.x,_p1.y,_p2.x,_p2.y));_r.rotate(_offsetAngle);_params&&_r.attr(_params);return _r};JC.f.safeTimeout(function(){FlowChart.autoInit&&FlowChart.init()},null,"JCFlowChart_INIT",1)});return JC.FlowChart})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
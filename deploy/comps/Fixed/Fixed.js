(function(b,a){b(["JC.common"],function(){(function(d){window.JC=window.JC||{log:function(){}};window.Fixed=JC.Fixed=c;function c(g){if(c.getInstance(g)){return c.getInstance(g)}c.getInstance(g,this);this._model=new f(g);this._view=new e(this._model);this._init()}c.prototype={_init:function(){d([this._view,this._model]).on("BindEvent",function(g,i,h){_p.on(i,h)});d([this._view,this._model]).on("TriggerEvent",function(g,i){var h=JC.f.sliceArgs(arguments);h.shift();h.shift();_p.trigger(i,h)});this._model.init();this._view.init();JC.log("Fixed init:",new Date().getTime());return this},show:function(){this._view.show();return this},hide:function(){this._view.hide();return this},layout:function(){return this._model.layout()},on:function(h,g){d(this).on(h,g);return this},trigger:function(h,g){d(this).trigger(h,g);return this}};c.getInstance=function(g,h){if(typeof g=="string"&&!/</.test(g)){g=d(g)}if(!(g&&g.length)||(typeof g=="string")){return}typeof h!="undefined"&&g.data("FixedIns",h);return g.data("FixedIns")};c.autoInit=true;c.durationms=300;c.stepms=3;c.interval=function(g){c._interval&&clearInterval(c._interval);g&&(c._interval=g)};function f(g){this._layout=g}f.prototype={init:function(){return this},isFixedTop:function(){return this._layout.is("[fixedtop]")},isFixedRight:function(){return this._layout.is("[fixedright]")},isFixedBottom:function(){return this._layout.is("[fixedbottom]")},isFixedLeft:function(){return this._layout.is("[fixedleft]")},isFixedCenter:function(){return this._layout.is("[fixedcenter]")},fixedtop:function(){return parseInt(this._layout.attr("fixedtop"),10)},fixedright:function(){return parseInt(this._layout.attr("fixedright"),10)},fixedbottom:function(){return parseInt(this._layout.attr("fixedbottom"),10)},fixedleft:function(){return parseInt(this._layout.attr("fixedleft"),10)},fixedcenter:function(){var g=(this._layout.attr("fixedcenter")||"").replace(/[^\d.,\-]/g,"").split(",");g.length<2&&g.push("0");g[0]=parseInt(g[0],10)||0;g[1]=parseInt(g[1],10)||0;return g},fixeddurationms:function(g){var h;this.layout().is("[fixeddurationms]")&&(h=parseInt(this.layout().attr("fixeddurationms")));g.is("[fixeddurationms]")&&(h=parseInt(g.attr("fixeddurationms")));typeof h=="undefined"&&(h=c.durationms);isNaN(h)&&(h=c.durationms);return h},fixedstepms:function(g){var h;this.layout().is("[fixedstepms]")&&(h=parseInt(this.layout().attr("fixedstepms")));g.is("[fixedstepms]")&&(h=parseInt(g.attr("fixedstepms")));typeof h=="undefined"&&(h=c.stepms);isNaN(h)&&(h=c.stepms);return h},fixedmoveto:function(g){var h="";g&&(g=d(g))&&g.length&&(h=g.attr("fixedmoveto")||"");return h.trim()},moveToItem:function(){var h=this.layout().is("[fixedmoveto]")?this.layout():null,g;if(!h){(g=this._layout.find("[fixedmoveto]")).length&&(h=g)}return h},layout:function(){return this._layout},fixedeffect:function(h){var i=true,g=this;g.layout().is("[fixedeffect]")&&(i=JC.f.parseBool(g.layout().attr("fixedeffect")));h&&h.is("[fixedeffect]")&&(i=JC.f.parseBool(h.attr("fixedeffect")));return i}};function e(g){this._model=g}e.prototype={init:function(){var g=this;d.support.isFixed?(this._initFixedSupport(),d(window).on("resize",function(){g._updateFixedSupport()})):this._initFixedUnsupport();this._initMoveTo();this._model.layout().show();return this},_initMoveTo:function(){var h=this,i=h._model.moveToItem();if(!(i&&i.length)){return}i.on("click",function(l){var k=d(this),j=h._model.fixedmoveto(k).toLowerCase();h._processMoveto(j,k)});d(window).on("resize",function(){c.interval()});JC.f.mousewheelEvent(function g(j){c.interval()})},_processMoveto:function(p,l){if(!p){return}var i=this,n=parseInt(p,10),j=d(document).height(),s=j-d(window).height(),m=d(document).scrollTop(),q=m,g=0,r,h,k,o;if(isNaN(n)){switch(p){case"top":n=0;break;case"bottom":n=s;break;default:o=d(p);if(o.length){n=o.offset().top}break}}(isNaN(n)||n<0)&&(n=0);n>s&&(n=s);if(m==n){return}r=n<m?true:false;h=m>n?m:n;k=m>n?n:m;if(!i._model.fixedeffect(l)){d(document).scrollTop(n);return}c.interval(JC.f.easyEffect(function(u,t){r&&(u=h-u+k);d(document).scrollTop(u)},h,k,i._model.fixeddurationms(l),i._model.fixedstepms(l)))},_initFixedSupport:function(){var h=this,g=h._model.layout().width(),l=h._model.layout().height(),j=d(window).width(),k=d(window).height(),i;if(h._model.isFixedCenter()){h._updateFixedSupport()}else{h._model.isFixedTop()&&h._model.layout().css("top",h._model.fixedtop()+"px");h._model.isFixedRight()&&h._model.layout().css("right",h._model.fixedright()+"px");h._model.isFixedBottom()&&h._model.layout().css("bottom",h._model.fixedbottom()+"px");h._model.isFixedLeft()&&h._model.layout().css("left",h._model.fixedleft()+"px")}h._model.layout().css("position","fixed")},_updateFixedSupport:function(){var h=this,o,n,i=d(document).scrollLeft(),j=h._model.layout().width(),l=h._model.layout().height(),g=d(window).width(),k=d(window).height(),m;if(h._model.isFixedCenter()){m=h._model.fixedcenter();o=g/2-j/2+m[0];n=k/2-l/2+m[1];h._model.layout().css("left",o+"px");h._model.layout().css("top",n+"px")}},_initFixedUnsupport:function(){var g=this;g._model.layout().css("position","absolute");g._updateFixedUnsupport();d(window).on("scroll resize",function(){g._updateFixedUnsupport()})},_updateFixedUnsupport:function(){var i=this,p,g,o,q,j=d(document).scrollTop(),k=d(document).scrollLeft(),l=i._model.layout().width(),n=i._model.layout().height(),h=d(window).width(),m=d(window).height();if(i._model.isFixedTop()){p=i._model.fixedtop()+j;i._model.layout().css("top",p+"px")}if(i._model.isFixedRight()){g=h-i._model.fixedright()-l+k;i._model.layout().css("left",g+"px")}if(i._model.isFixedBottom()){o=j+m-i._model.fixedbottom()-n;i._model.layout().css("top",o+"px")}if(i._model.isFixedLeft()){q=k+i._model.fixedleft();i._model.layout().css("left",q+"px")}},hide:function(){},show:function(){}};d(document).ready(function(){if(!c.autoInit){return}d(["div.js_autoFixed","dl.js_autoFixed","ul.js_autoFixed","ol.js_autoFixed","button.js_autoFixed"].join()).each(function(){new c(d(this))})})}(jQuery));return JC.Fixed})}(typeof define==="function"&&define.amd?define:function(a,b){b&&b()},this));
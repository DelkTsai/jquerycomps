(function(b,a){b(["JC.common"],function(){window.Fixed=JC.Fixed=c;function c(f){if(c.getInstance(f)){return c.getInstance(f)}c.getInstance(f,this);this._model=new e(f);this._view=new d(this._model);this._init()}c.prototype={_init:function(){$([this._view,this._model]).on("BindEvent",function(f,h,g){_p.on(h,g)});$([this._view,this._model]).on("TriggerEvent",function(f,h){var g=JC.f.sliceArgs(arguments);g.shift();g.shift();_p.trigger(h,g)});this._model.init();this._view.init();JC.log("Fixed init:",new Date().getTime());return this},show:function(){this._view.show();return this},hide:function(){this._view.hide();return this},layout:function(){return this._model.layout()},on:function(g,f){$(this).on(g,f);return this},trigger:function(g,f){$(this).trigger(g,f);return this}};c.getInstance=function(f,g){if(typeof f=="string"&&!/</.test(f)){f=$(f)}if(!(f&&f.length)||(typeof f=="string")){return}typeof g!="undefined"&&f.data("FixedIns",g);return f.data("FixedIns")};c.autoInit=true;c.durationms=200;c.stepms=3;c.interval=function(f){c._interval&&clearInterval(c._interval);f&&(c._interval=f)};function e(f){this._layout=f}e.prototype={init:function(){return this},isFixedTop:function(){return this._layout.is("[fixedtop]")},isFixedRight:function(){return this._layout.is("[fixedright]")},isFixedBottom:function(){return this._layout.is("[fixedbottom]")},isFixedLeft:function(){return this._layout.is("[fixedleft]")},isFixedCenter:function(){return this._layout.is("[fixedcenter]")},fixedtop:function(){return parseInt(this._layout.attr("fixedtop"),10)},fixedright:function(){return parseInt(this._layout.attr("fixedright"),10)},fixedbottom:function(){return parseInt(this._layout.attr("fixedbottom"),10)},fixedleft:function(){return parseInt(this._layout.attr("fixedleft"),10)},fixedAutoHide:function(){return JC.f.parseBool(this._layout.attr("fixedAutoHide"))},fixedcenter:function(){var f=(this._layout.attr("fixedcenter")||"").replace(/[^\d.,\-]/g,"").split(",");f.length<2&&f.push("0");f[0]=parseInt(f[0],10)||0;f[1]=parseInt(f[1],10)||0;return f},fixeddurationms:function(f){var g;this.layout().is("[fixeddurationms]")&&(g=parseInt(this.layout().attr("fixeddurationms")));f.is("[fixeddurationms]")&&(g=parseInt(f.attr("fixeddurationms")));typeof g=="undefined"&&(g=c.durationms);isNaN(g)&&(g=c.durationms);return g},fixedstepms:function(f){var g;this.layout().is("[fixedstepms]")&&(g=parseInt(this.layout().attr("fixedstepms")));f.is("[fixedstepms]")&&(g=parseInt(f.attr("fixedstepms")));typeof g=="undefined"&&(g=c.stepms);isNaN(g)&&(g=c.stepms);return g},fixedmoveto:function(f){var g="";f&&(f=$(f))&&f.length&&(g=f.attr("fixedmoveto")||"");return g.trim()},moveToItem:function(){var g=this.layout().is("[fixedmoveto]")?this.layout():null,f;if(!g){(f=this._layout.find("[fixedmoveto]")).length&&(g=f)}return g},layout:function(){return this._layout},fixedeffect:function(g){var h=true,f=this;f.layout().is("[fixedeffect]")&&(h=JC.f.parseBool(f.layout().attr("fixedeffect")));g&&g.is("[fixedeffect]")&&(h=JC.f.parseBool(g.attr("fixedeffect")));return h}};function d(f){this._model=f}d.prototype={init:function(){var f=this;$.support.isFixed?(this._initFixedSupport(),$(window).on("resize",function(){f._updateFixedSupport()})):this._initFixedUnsupport();this._initMoveTo();$(f).on("hide_layout",function(){f._model.layout().hide()});$(f).on("show_layout",function(){f._model.layout().show()});if(f._model.fixedAutoHide()){if(JDOC.scrollTop()<=20){$(f).trigger("hide_layout")}JDOC.on("scroll",function(){if(JDOC.scrollTop()<=20){$(f).trigger("hide_layout")}else{$(f).trigger("show_layout")}})}else{$(f).trigger("show_layout")}return this},_initMoveTo:function(){var g=this,h=g._model.moveToItem();if(!(h&&h.length)){return}h.on("click",function(k){var j=$(this),i=g._model.fixedmoveto(j).toLowerCase();g._processMoveto(i,j)});$(window).on("resize",function(){c.interval()});JC.f.mousewheelEvent(function f(i){c.interval()})},_processMoveto:function(o,k){if(!o){return}var h=this,m=parseInt(o,10),i=$(document).height(),r=i-$(window).height(),l=$(document).scrollTop(),p=l,f=0,q,g,j,n;if(isNaN(m)){switch(o){case"top":m=0;break;case"bottom":m=r;break;default:n=$(o);if(n.length){m=n.offset().top}break}}(isNaN(m)||m<0)&&(m=0);m>r&&(m=r);if(l==m){return}q=m<l?true:false;g=l>m?l:m;j=l>m?m:l;if(!h._model.fixedeffect(k)){$(document).scrollTop(m);return}c.interval(JC.f.easyEffect(function(t,s){q&&(t=g-t+j);$(document).scrollTop(t)},g,j,h._model.fixeddurationms(k),h._model.fixedstepms(k)))},_initFixedSupport:function(){var g=this,f=g._model.layout().width(),k=g._model.layout().height(),i=$(window).width(),j=$(window).height(),h;if(g._model.isFixedCenter()){g._updateFixedSupport()}else{g._model.isFixedTop()&&g._model.layout().css("top",g._model.fixedtop()+"px");g._model.isFixedRight()&&g._model.layout().css("right",g._model.fixedright()+"px");g._model.isFixedBottom()&&g._model.layout().css("bottom",g._model.fixedbottom()+"px");g._model.isFixedLeft()&&g._model.layout().css("left",g._model.fixedleft()+"px")}g._model.layout().css("position","fixed")},_updateFixedSupport:function(){var g=this,n,m,h=$(document).scrollLeft(),i=g._model.layout().width(),k=g._model.layout().height(),f=$(window).width(),j=$(window).height(),l;if(g._model.isFixedCenter()){l=g._model.fixedcenter();n=f/2-i/2+l[0];m=j/2-k/2+l[1];g._model.layout().css("left",n+"px");g._model.layout().css("top",m+"px")}},_initFixedUnsupport:function(){var f=this;f._model.layout().css("position","absolute");f._updateFixedUnsupport();$(window).on("scroll resize",function(){f._updateFixedUnsupport()})},_updateFixedUnsupport:function(){var h=this,o,f,n,p,i=$(document).scrollTop(),j=$(document).scrollLeft(),k=h._model.layout().width(),m=h._model.layout().height(),g=$(window).width(),l=$(window).height();if(h._model.isFixedTop()){o=h._model.fixedtop()+i;h._model.layout().css("top",o+"px")}if(h._model.isFixedRight()){f=g-h._model.fixedright()-k+j;h._model.layout().css("left",f+"px")}if(h._model.isFixedBottom()){n=i+l-h._model.fixedbottom()-m;h._model.layout().css("top",n+"px")}if(h._model.isFixedLeft()){p=j+h._model.fixedleft();h._model.layout().css("left",p+"px")}},hide:function(){},show:function(){}};window.jQuery&&jQuery.support&&(jQuery.support.isFixed=(function(i){try{var f,m=i(document.documentElement),g=i("<div style='position:fixed;top:100px;visibility:hidden;'>x</div>").appendTo(m),j=m[0].style.height,n=window,o=i(n),h=o.scrollLeft(),l=o.scrollTop();m.height(screen.height*2+"px");n.scrollTo(0,100);f=g[0].getBoundingClientRect().top===100;m.height(j);g.remove();n.scrollTo(h,l);return f}catch(k){alert(k.message)}})(jQuery));$(document).ready(function(){if(!c.autoInit){return}$(["div.js_autoFixed","dl.js_autoFixed","ul.js_autoFixed","ol.js_autoFixed","button.js_autoFixed","a.js_autoFixed"].join()).each(function(){new c($(this))})});return JC.Fixed})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
(function(b,a){b(["JC.common"],function(){window.Tips=JC.Tips=e;function e(h){h=$(h);if(!(h&&h.length)){return this}if(h.length>1){return e.init(h)}if(e.getInstance(h)){return e.getInstance(h)}e.getInstance(h,this);this._model=new g(h);this._view=new f(this._model);this._init()}e.prototype={_init:function(){var h=this;$(this._view).on("BindEvent",function(i,k,j){h.on(k,j)});$(this._view).on("TriggerEvent",function(i,k,j){h.trigger(k,j)});this._view.init();this._model.selector().on("mouseenter",c);return this},show:function(h){this._view.show(h);return this},hide:function(){this._view.hide();return this},selector:function(){return this._model.selector()},layout:function(h){return this._view.layout(h)},data:function(){return this._model.data()},on:function(i,h){$(this).on(i,h);return this},trigger:function(i,h){$(this).trigger(i,h);return this}};e.init=function(h){if(!h){return}h=$(h);if(!h.length){return}var i=[];h.each(function(){var j=$(this);if(e.getInstance(j)){return}i.push(new e(j))});return i};e.hide=function(){$("body > div.UTips").hide()};e.autoInit=true;e.tpl=null;e.offset={bottom:{x:15,y:15},left:{x:-28,y:5},top:{x:-2,y:-22}};e.minWidth=200;e.maxWidth=400;e.titleToTipsdata=function(h){h=$(h);if(!JC.Tips.autoInit||(typeof window.event=="object"&&document.attachEvent)){h.each(function(){$(this).attr("tipsData",$(this).attr("title")).removeAttr("title")})}};e.getInstance=function(h,i){i&&h&&$(h).data("TipsIns",i);return h?$(h).data("TipsIns"):null};function g(h){this.tpl=d;this._selector=h;this._data;this._init()}g.prototype={_init:function(){this.update();return this},data:function(h){h&&this.update();return this._data},update:function(){if(!(this._selector.attr("title")||this._selector.attr("tipsData"))){return}this._data=$.trim(this._selector.attr("title")||this._selector.attr("tipsData")).replace(/(?:\r\n|\n\r|\r|\n)/g,"<br />");this._selector.removeAttr("title").removeAttr("tipsData");if(this.isInited()){return}this.isInited(true)},isInited:function(h){typeof h!="undefined"&&(this._selector.data("initedTips",h));return this._selector.data("initedTips")},selector:function(){return this._selector},tipsinitedcallback:function(){var h;this._selector.attr("tipsinitedcallback")&&(h=window[this._selector.attr("tipsinitedcallback")]);return h},tipsshowcallback:function(){var h;this._selector.attr("tipsshowcallback")&&(h=window[this._selector.attr("tipsshowcallback")]);return h},tipshidecallback:function(){var h;this._selector.attr("tipshidecallback")&&(h=window[this._selector.attr("tipshidecallback")]);return h},tipstemplatebox:function(){var h;this._selector.is("[tipstemplatebox]")&&(h=$(this._selector.attr("tipstemplatebox")).html().trim().replace(/[\r\n]+/g,""));this._selector.is("[tipstemplatesbox]")&&(h=$(this._selector.attr("tipstemplatesbox")).html().trim().replace(/[\r\n]+/g,""));return h},tipstemplatesbox:function(){return this.tipstemplatebox()},tipsupdateonce:function(){var h;this._selector.attr("tipsupdateonce")&&(h=JC.f.parseBool(this._selector.attr("tipsupdateonce")));return h},tipsIsUpdated:function(h){typeof h!="undefined"&&this._selector.data("TipsUpdated",h);return this._selector.data("TipsUpdated")},layout:function(){if(!this._layout){if(this.tipstemplatesbox()){this._layout=$(this.tipstemplatesbox());this._layout.appendTo(document.body)}else{this._layout=$("#JCTipsLayout");if(!(this._layout&&this._layout.length)){this._layout=$(this.tipstemplatesbox()||JC.Tips.tpl||this.tpl);this._layout.attr("id","JCTipsLayout").css("position","absolute");this._layout.appendTo(document.body)}}}return this._layout}};function f(h){this._model=h;this._layout}f.prototype={init:function(){$(this).trigger("BindEvent",["TipsShow",this._model.tipsshowcallback()]);$(this).trigger("BindEvent",["TipsHide",this._model.tipshidecallback()]);$(this).trigger("BindEvent",["TipsInited",this._model.tipsinitedcallback()]);return this},show:function(j){var r=j.pageX,q=j.pageY;r+=JC.Tips.offset.bottom.x;q+=JC.Tips.offset.bottom.y;var o=$(document).scrollTop(),n=$(document).scrollLeft();var k=$(window).width(),m=$(window).height();var s=this.layout().width(),p=this.layout().height();var u=n+k-s,h=n;var t=o+m-p,v=o;var l=false,i=false;r>u&&(r=r-s+JC.Tips.offset.left.x,q+=JC.Tips.offset.left.y,l=true);r<h&&(r=h);q>t&&(q=q-p+JC.Tips.offset.top.y,r+=JC.Tips.offset.top.x,i=true);q<v&&(q=v);l&&i&&(q-=5);this.layout().css({left:r+"px",top:q+"px"});this.layout().show();$(this).trigger("TriggerEvent",["TipsShow",this._model.tipsshowcallback()])},hide:function(){this.layout().hide();$(this).trigger("TriggerEvent","TipsHide")},layout:function(h){this._layout=this._model.layout();h&&this.update();return this._layout},update:function(){if(this._model.tipsupdateonce()&&this._model.tipsIsUpdated()){return}var i=this._model.data(1);this._layout.html(i).css({width:"auto",left:"-9999px",top:"-9999px",display:"block"});var h=this._layout.width(),j=this._layout.height();h<JC.Tips.minWidth&&this._layout.css("width",JC.Tips.minWidth+"px");h>JC.Tips.maxWidth&&this._layout.css("width",JC.Tips.maxWidth+"px");this._model.tipsIsUpdated(true)}};function c(k){var j=$(this),i=e.getInstance(j);i.layout(1).css("z-index",ZINDEX_COUNT++);if(!i.data()){return}i.show(k);$(document).on("mousemove",h);j.on("mouseleave",l);function h(m){if(!i.layout().is(":visible")){$(document).unbind("mousemove",h);$(j).unbind("mouseleave",l);return}i.show(m)}function l(m){$(document).unbind("mousemove",h);$(j).unbind("mouseleave",l);i.hide()}}var d='<div class="UTips"></div>';$(document).ready(function(h){setTimeout(function(){if(!JC.Tips.autoInit){return}e.titleToTipsdata($("[title]"));$(document).delegate("*","mouseover",function(j){var i=$(this);if(e.getInstance(i)){return}if(!(i.attr("title")||i.attr("tipsData"))){return}JC.Tips.init(i);c.call(this,j)})},10)});return JC.Tips})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
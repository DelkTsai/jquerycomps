(function(b,a){b(["JC.BaseMVC"],function(){var d=$(document),c=$(window);JC.AutoFixed=e;function e(f){f&&(f=$(f));if(JC.BaseMVC.getInstance(f,e)){return JC.BaseMVC.getInstance(f,e)}JC.BaseMVC.getInstance(f,e,this);this._model=new e.Model(f);this._view=new e.View(this._model);this._init()}e.init=function(f){var g=[];f=$(f||document);if(f.length){if(f.hasClass("js_compAutoFixed")){g.push(new e(f))}else{f.find("div.js_compAutoFixed").each(function(){g.push(new e(this))})}}return g};JC.BaseMVC.build(e);JC.f.extendObject(e.prototype,{_beforeInit:function(){},_initHanlderEvent:function(){var f=this;f.on("inited",function(){var h=JDOC.scrollTop(),g=f._model.defaultStyle().top;if(JDOC.scrollTop()>0){JC.dir(f._model.defaultStyle());f.trigger("UPDATE_POSITION",[h,g])}});f._model.saveDefault();JWIN.on("scroll",function(h){var i=JDOC.scrollTop(),g=f._model.defaultStyle().gtop;f.trigger("UPDATE_POSITION",[i,g])});JWIN.on("resize",function(g){var h=f._model.cloneItem(),i;if(!h){f._model.normalClass()&&f.selector().removeClass(f._model.normalClass())&&f.selector().addClass(f._model.normalClass());i=f.selector().width()}else{if(f._model.defaultStyle().right!="auto"){f.selector().css({right:JC.f.winSize().width-(h.offset().left+h.width())});return}i=h.width();f.selector().css({width:i})}f._model.defaultStyle().width=i});f.on("UPDATE_POSITION",function(h,i,g){if((i)>(g-f._model.fixedTopPx())){f.trigger("FIXED",[i,g])}else{f.trigger("UN_FIXED",[i,g])}});f.on("FIXED",function(h,l,i){var n=f._model.defaultStyle(),o=0,m,k=JC.f.winSize(),j,g;if(f._model.cloneItem()){return}if(f._model.fixedLock()){return}f._model.fixedLock(true);f._model.unfixedLock(false);JC.log("FIXED",l,i);if(n.left!=n.gleft){o=n.gleft}else{o=n.left}j=n.height;if(j+f._model.fixedTopPx()>k.height){j=k.height-f._model.fixedTopPx()}f.trigger("CLONE_ITEM");g=f._model.cloneItem();m={position:"fixed",top:f._model.fixedTopPx(),height:j,width:n.width};if(n.right!="auto"){m.right=k.width-(g.offset().left+g.width())}else{m.left=o}f.selector().css(m);f._model.normalClass()&&f.selector().removeClass(f._model.normalClass());f._model.fixedClass()&&f.selector().addClass(f._model.fixedClass())});f.on("UN_FIXED",function(i,k,h){if(f._model.unfixedLock()){return}f._model.unfixedLock(true);f._model.fixedLock(false);var g=f._model.defaultStyle(),j;JC.log("UN_FIXED",k,h);f.trigger("UN_CLONE_ITEM");j={position:g.position,top:g.top,height:g.height};if(g.right!="auto"){j.right=g.right}else{j.left=g.left}f.selector().css(j);f._model.fixedClass()&&f.selector().removeClass(f._model.fixedClass());f._model.normalClass()&&f.selector().addClass(f._model.normalClass())});f.on("CLONE_ITEM",function(){if(f._model.cloneItem()){return}var h=$("<div />"),g=f._model.defaultStyle();h.css({visibility:"hidden",height:g.height,overflow:"hidden",position:g.position,right:g.right,width:g.width});f._model.cloneItemClass()&&h.addClass(f._model.cloneItemClass());h.html("");f._model.cloneItem(h);f.selector().after(h)});f.on("UN_CLONE_ITEM",function(){f._model.cloneItem(null)})},_inited:function(){this.trigger("inited")}});e.Model._instanceName="JCAutoFixed";JC.f.extendObject(e.Model.prototype,{init:function(){},defaultStyle:function(){var f={position:"static",left:0,top:0,right:0,bottom:0,width:0,height:0,gleft:0,gtop:0,winSize:JC.f.winSize()};return this._defaultStyle||f},fixedLock:function(f){typeof f!="undefined"&&(this._fixedLock=f);return this._fixedLock},unfixedLock:function(f){typeof f!="undefined"&&(this._unfixedLock=f);return this._unfixedLock},saveDefault:function(){var f=this,i=f.defaultStyle(),h=f.selector().position(),g=f.selector().offset();i.owidth=f.selector().css("width");i.gleft=g.left;i.gtop=g.top;i.position=f.selector().css("position");i.left=h.left;i.top=h.top;i.width=f.selector().width();i.height=f.selector().height();i.right=f.selector().css("right");i.bottom=f.selector().css("bottom");f._defaultStyle=i},fixedTopPx:function(){typeof this._fixedTopPx=="undefined"&&(this._fixedTopPx=this.floatProp("data-fixedTopPx"));return this._fixedTopPx},fixedClass:function(){return this.attrProp("data-fixedClass")},normalClass:function(){return this.attrProp("data-normalClass")},cloneItemClass:function(){return this.attrProp("data-cloneItemClass")},cloneItem:function(f){if(typeof f!="undefined"){if(!f&&this._cloneItem){this._cloneItem.remove()}this._cloneItem=f}return this._cloneItem}});JC.f.extendObject(e.View.prototype,{init:function(){}});d.ready(function(){JC.f.safeTimeout(function(){e.autoInit&&e.init()},null,"AutoFixed23asdfa",1)});return JC.AutoFixed})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
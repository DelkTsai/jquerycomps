(function(b,a){b(["JC.BaseMVC"],function(){var d=$(document),c=$(window);JC.NumericStepper=e;function e(f){f&&(f=$(f));if(JC.BaseMVC.getInstance(f,e)){return JC.BaseMVC.getInstance(f,e)}JC.BaseMVC.getInstance(f,e,this);this._model=new e.Model(f);this._view=new e.View(this._model);this._init();JC.log(e.Model._instanceName,"all inited",new Date().getTime())}e.init=function(f){var g=[];f=$(f||document);if(f.length){if(f.hasClass("js_compNumericStepper")){g.push(new e(f))}else{f.find("div.js_compNumericStepper, span.js_compNumericStepper").each(function(){g.push(new e(this))})}}return g};e.redoMs=100;e.timeoutMs=500;e.defaultMouseUp=function(f){if(!e._currentIns){return}JC.f.safeTimeout(null,e._currentIns._model.cnsTarget(),e.Model.REDO_TM_NAME);e.Model.interval&&clearInterval(e.Model.interval)};e._currentIns;JC.BaseMVC.build(e);JC.f.extendObject(e.prototype,{_beforeInit:function(){},_initHanlderEvent:function(){var f=this;f._model.cnsMinusButton()&&(f._model.cnsMinusButton().on("mousedown",function(g){e._currentIns=f;f.trigger(e.Model.CALC,[e.Model.CALC_MINUS]);JC.f.safeTimeout(function(){e.Model.interval&&clearInterval(e.Model.interval);e.Model.interval=setInterval(function(){f.trigger(e.Model.CALC,[e.Model.CALC_MINUS])},f._model.cnsRedoMs())},f._model.cnsTarget(),e.Model.REDO_TM_NAME,f._model.cnsTimeoutMs());c.on("mouseup",e.defaultMouseUp)}),f._model.cnsMinusButton().each(function(){BaseMVC.getInstance($(this),e,f)}));f._model.cnsPlusButton()&&(f._model.cnsPlusButton().on("mousedown",function(g){e._currentIns=f;f.trigger(e.Model.CALC,[e.Model.CALC_PLUS]);JC.f.safeTimeout(function(){e.Model.interval&&clearInterval(e.Model.interval);e.Model.interval=setInterval(function(){f.trigger(e.Model.CALC,[e.Model.CALC_PLUS])},f._model.cnsRedoMs())},f._model.cnsTarget(),e.Model.REDO_TM_NAME,f._model.cnsTimeoutMs());c.on("mouseup",e.defaultMouseUp)}),f._model.cnsPlusButton().each(function(){BaseMVC.getInstance($(this),e,f)}));f.on(e.Model.CALC,function(i,k){if(!(f._model.cnsTarget()&&f._model.cnsTarget().length)){return}var n=f._model.val(),m=n,l=f._model.step(),g=f._model.fixed(),h=f._model.minvalue(),j=f._model.maxvalue();switch(k){case e.Model.CALC_MINUS:m-=l;f._model.isMinvalue()&&m<h&&(m=h);break;case e.Model.CALC_PLUS:m+=l;f._model.isMaxvalue()&&m>j&&(m=j);break}if(m===n){return}if(f._model.cnsBeforeChangeCb()&&f._model.cnsBeforeChangeCb().call(f._model.cnsTarget(),m,n,f)===false){return}f._model.cnsTarget().val(JC.f.parseFinance(m,g).toFixed(g));f._model.cnsChangeCb()&&f._model.cnsChangeCb().call(f._model.cnsTarget(),m,n,f)})},_inited:function(){this._view.initStyle()},plus:function(){this.trigger(e.Model.CALC,[e.Model.CALC_PLUS]);return this},minus:function(){this.trigger(e.Model.CALC,[e.Model.CALC_MINUS]);return this}});e.Model._instanceName="JCNumericStepper";e.Model.CALC="calc";e.Model.CALC_MINUS="minus";e.Model.CALC_PLUS="plus";e.Model.CLASS_ICON="cnsIcon";e.Model.CLASS_MINUS="cnsMinus";e.Model.CLASS_PLUS="cnsPlus";e.Model.REDO_TM_NAME="cnsTm";JC.f.extendObject(e.Model.prototype,{init:function(){},cnsTarget:function(){return this.selectorProp("cnsTarget")},cnsMinusButton:function(){return this.selectorProp("cnsMinusButton")},cnsPlusButton:function(){return this.selectorProp("cnsPlusButton")},cnsBeforeChangeCb:function(){return this.callbackProp("cnsBeforeChangeCb")||e.beforeChangeCb},cnsChangeCb:function(){return this.callbackProp("cnsChangeCb")||e.changeCb},cnsRedoMs:function(){return this.intProp("cnsRedoMs")||e.redoMs},cnsTimeoutMs:function(){return this.intProp("cnsTimeoutMs")||e.timeoutMs},isMinvalue:function(){return this.cnsTarget().is("[minvalue]")},isMaxvalue:function(){return this.cnsTarget().is("[maxvalue]")},val:function(){return this.getVal(this.cnsTarget().val())},minvalue:function(){return this.getVal(this.cnsTarget().attr("minvalue"))},maxvalue:function(){return this.getVal(this.cnsTarget().attr("maxvalue"))},step:function(){return this.getVal(this.cnsTarget().attr("step"))||1},fixed:function(){return this.getVal(this.cnsTarget().attr("fixed"))||0},getVal:function(f){var g=0;f&&(f=f.toString().trim());if(f){if(/\./.test(f)){g=JC.f.parseFinance(f,f.split(".")[1].length||this.fixed())}else{g=parseInt(f,10)||0}}return g}});JC.f.extendObject(e.View.prototype,{init:function(){},initStyle:function(){var f=this;f._model.cnsMinusButton()&&f._model.cnsMinusButton().addClass(e.Model.CLASS_ICON).addClass(e.Model.CLASS_MINUS);f._model.cnsPlusButton()&&f._model.cnsPlusButton().addClass(e.Model.CLASS_ICON).addClass(e.Model.CLASS_PLUS)}});d.ready(function(){});$(document).delegate("div.js_compNumericStepper, span.js_compNumericStepper","mouseenter",function(g){var f=$(this),h=JC.BaseMVC.getInstance(f,e);!h&&(new e(f))});$(document).delegate("div.js_compNumericStepper .cnsIcon, span.js_compNumericStepper .cnsIcon","click",function(g){var f=$(this),h=JC.BaseMVC.getInstance(f,e);if(!h){var i=JC.f.getJqParent(f,".js_compNumericStepper");if(!(i&&i.length)){return}h=new e(i);f.hasClass("cnsPlus")?h.plus():h.minus()}});return JC.NumericStepper})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
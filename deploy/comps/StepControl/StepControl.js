(function(b,a){b(["JC.BaseMVC","JC.Valid"],function(){var e=$(document),d=$(window);JC.StepControl=c;function c(f){f&&(f=$(f));if(JC.BaseMVC.getInstance(f,c)){return JC.BaseMVC.getInstance(f,c)}JC.BaseMVC.getInstance(f,c,this);this._model=new c.Model(f);this._view=new c.View(this._model);this._init();JC.log(c.Model._instanceName,"all inited",new Date().getTime())}c.init=function(f){var g=[];f=$(f||document);if(f.length){if(f.hasClass("js_compStepControl")){g.push(new c(f))}else{f.find("div.js_compStepControl").each(function(){g.push(new c(this))})}}return g};JC.BaseMVC.build(c);JC.f.extendObject(c.prototype,{_beforeInit:function(){},_initHanlderEvent:function(){var f=this;f.on("inited",function(){f.trigger("show_index");f._model.cscInitedCallback()&&f._model.cscInitedCallback().call(f,f.selector())});f._model.cscItems().each(function(h,g){g=$(g);g.delegate(".js_cscNext","click",function(){var i=$(this);f.trigger("next_index",[g,i])});g.delegate(".js_cscPrev","click",function(){var i=$(this);f.trigger("prev_index",[g,i])})});f.on("prev_index",function(h,i,g){JC.log("prev_index",JC.f.ts());var k=f._model.cscValidCallback(g)||f._model.cscValidCallback(i),l,j;j=f._model.cscIndex()-1;if(j>=0){f.trigger("show_index",[f._model.cscIndex(j)])}});f.on("next_index",function(h,j,g){if(!(j)){return}JC.log("next_index",JC.f.ts());var l=f._model.cscValidCallback(g)||f._model.cscValidCallback(j),m,k,i;if(g&&(g.attr("type").toLowerCase()=="button"||g.attr("type").toLowerCase()=="input")){if(l){m=l().call(f,g,j)}else{m=JC.Valid(j)}}else{m=true}JC.log("_canNext",m,JC.f.ts());if(!m){return}k=f._model.cscIndex()+1;JC.log(k,f._model.maxIndex(),f._model.cscIndex());if(k<=f._model.maxIndex()){f.trigger("show_index",[f._model.cscIndex(k)])}});f.on("show_index",function(h,g){var j=f._model.cscIndex(),k=f._model.cscItems(),i=f._model.cscLabels();typeof g!="undefined"&&(j=g);k&&k.length&&k.hide().eq(j).show();i&&i.length&&i.removeClass(f._model.cscActiveClass()).eq(j).addClass(f._model.cscActiveClass())})},_inited:function(){this.trigger("inited")},prev:function(){var f=this,g=f._model.current(".js_cscPrev");if(g.item){f.trigger("prev_index",[g.item,g.button])}return this},next:function(){var f=this,g=f._model.current(".js_cscNext");if(g.item){f.trigger("next_index",[g.item,g.button])}return this},first:function(){this.trigger("show_index",[this._model.cscIndex(0)]);return this},last:function(){var f;this._model.cscItems()&&this._model.cscItems().length&&(f=this._model.cscItems().length-1);typeof f!="undefined"&&this.trigger("show_index",[this._model.cscIndex(f)]);return this}});c.Model._instanceName="JCStepControl";JC.f.extendObject(c.Model.prototype,{init:function(){var f=this;f.cscIndex(f.cscDefaultIndex()||0)},next:function(){var f=this,i=this.cscIndex()+1,k={item:null,label:null,button:null,selector:f.selector()},j=f.cscItems(),g=f.cscLabels(),h;if(j[i]){k.item=$(j[i]);h=k.item.find(".js_cscNext");h.length&&(k.button=h)}g&&g.length&&g[i]&&(k.label=$(g[i]));return k},prev:function(){var f=this,h=this.cscIndex()-1,j={item:null,label:null,selector:f.selector()},i=f.cscItems(),g=f.cscLabels();i[h]&&(j.item=$(i[h]));g&&g.length&&g[h]&&(j.label=$(g[h]));return j},current:function(g){g=g||".js_cscNext";var f=this,j=this.cscIndex(),l={item:null,label:null,button:null,selector:f.selector()},k=f.cscItems(),h=f.cscLabels(),i;if(k[j]){l.item=$(k[j]);i=l.item.find(g);i.length&&(l.button=i)}h&&h.length&&h[j]&&(l.label=$(h[j]));return l},maxIndex:function(){var f=this.cscItems().length-1;f<0&&(f=0);return f},cscIndex:function(f){typeof f!="undefined"&&(this._cscIndex=f);return this._cscIndex},cscValidCallback:function(f){if(!f){return null}return this.callbackProp(f,"cscValidCallback")},cscInitedCallback:function(){return this.callbackProp("cscInitedCallback")},cscItems:function(){return this.selectorProp("cscItems")},cscLabels:function(){return this.selectorProp("cscLabels")},cscActiveClass:function(){return this.attrProp("cscActiveClass")},cscDefaultIndex:function(){return this.intProp("cscDefaultIndex")||0}});JC.f.extendObject(c.View.prototype,{init:function(){}});e.ready(function(){setTimeout(function(){c.autoInit&&c.init()},1)});return JC.StepControl})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
(function(b,a){b(["JC.common"],function(){var d=$(document),c=$(window),e;JC.FrameUtil=e={eventHost:{},heightOffset:0,autoUpdateSizeMs:1000,childSizePattern:1,isChildAutoClose:true,isChildAutoSize:true,id:function(){return e._id},noticeSize:function(f){try{f=e.type(f);if(!e.parent()){return e}var h={type:f};e.parent().jEventHost.trigger("size",[e.info(h)])}catch(g){JC.error("JC.FrameUtil noticeSize",g.message)}return e},autoNoticeSize:function(g,f){typeof g=="undefined"&&(g=e.autoUpdateSizeMs);$(e).data("FUI_noticeSize")&&clearInterval($(e).data("FUI_noticeSize"));e.noticeSize(f);g&&$(e).data("FUI_noticeSize",setInterval(function(){e.noticeSize(f)},g));return e},subscribeEvent:function(f,g){if(!f){return e}$(e.eventHost).on(f,g);return e},noticeData:function(h,f){try{if(!(h)){return e}if(!e.parent()){return e}f=e.type(f);e.parent().jEventHost.trigger("data",e.info({data:h,type:f}))}catch(g){JC.error("JC.FrameUtil noticeData",g.message)}return e},noticeReload:function(g,f){if(!e.parent()){return e}f=e.type(f);e.parent().jEventHost.trigger("reload",e.info({url:g,type:f}));return e},noticeReady:function(f){if(!e.parent()){return e}try{f=e.type(f);e.parent()&&e.parent().jEventHost.trigger("ready",e.info({type:f}))}catch(g){JC.error("JC.FrameUtil noticeReady",g.message)}return e},noticeChildData:function(f,g){if(!(f)){return e}f.type=e.type(g)||f.type;e.info().jEventHost.trigger("childData",e.info(f));return e},noticeClose:function(f){try{f=e.type(f);e.parent().jEventHost.trigger("close",e.info({type:f}))}catch(g){JC.error("JC.FrameUtil noticeClose",g.message)}return e},info:function(g){var i=$(document.body),f=JC.f.docSize(),h={"$":$,width:f.width,height:f.height,bodyWidth:f.bodyWidth,bodyHeight:f.bodyHeight,id:e.id(),eventHost:e.eventHost,jEventHost:$(e.eventHost),FrameUtil:e};g&&(h=JC.f.extendObject(h,g));return h},parent:function(){var f;if(window.parent&&window.parent!=window&&window.parent.$&&window.parent.JC&&window.parent.JC.FrameUtil){f={"$":window.parent.$,win:window.parent,jwin:window.parent.$(window.parent),JC:window.parent.JC,eventHost:window.parent.JC.FrameUtil.eventHost,jEventHost:window.parent.$(window.parent.JC.FrameUtil.eventHost),id:window.parent.JC.FrameUtil.id(),FrameUtil:window.parent.JC.FrameUtil}}return f},frameInfo:function(i,l){i&&(i=$(i));var m=null;if(i&&i.length){try{var k=i.prop("contentWindow"),j=i.prop("contentDocument"),f=JC.f.getUrlParam(i.attr("src")||"","jsAction")||k.name||"",h=JC.f.docSize(j)}catch(g){JC.error("JC.FrameUtil frameInfo",g.message);return m}m={"$":k.$,width:h.width,height:h.height,bodyWidth:h.bodyWidth,bodyHeight:h.bodyHeight,docWidth:h.docWidth,docHeight:h.docHeight,win:k,doc:j,type:f,id:""};j&&j.body&&(m.bodyWidth=j.body.offsetWidth,m.bodyHeight=j.body.offsetHeight);if(k.JC&&k.JC.FrameUtil){m.id=k.JC.FrameUtil.id()}l&&(m=JC.f.extendObject(m,l))}return m},type:function(f,h,g){if(!f){g&&(g=$(g));if(g&&g.length){f=JC.f.getUrlParam(g.attr("jsAction")||"","jsAction");f=f||g.prop("contentWindow").name||""}else{f=JC.f.getUrlParam("jsAction");f=f||window.name||""}}f&&h&&(f+=h);return f},updateChildrenSize:function(f){f&&(f=$(f));if(!(f&&f.length)){return e}f.each(function(){e.updateChildSize($(this))});return e},updateChildSize:function(f){f&&(f=$(f));if(!(f&&f.length)){return e}if(!f.is(":visible")){return e}var h,g;h=e.frameInfo(f);if(!h){return}if(!h.height){return e}f.css(e.cssFromSizePattern(e.childSizePattern,h));f.css("height",h.height+"px");return e},childrenAutoSize:function(g,h){g&&(g=$(g));if(!(g&&g.length)){return e}typeof h=="undefined"&&(h=e.autoUpdateSizeMs);var f={frames:g};e.updateChildrenSize(g);g.data("FUI_autoSize")&&clearInterval(g.data("FUI_autoSize"));h&&g.data("FUI_autoSize",setInterval(function(){e.updateChildrenSize(g)},h));return e},childIdMap:function(f){var g;if(f){if(f in e._childIdMap){g=e._childIdMap[f]}else{$("iframe").each(function(h){var j=$(this),i=j.prop("contentWindow");if(i&&i.JC&&i.JC.FrameUtil&&i.JC.FrameUtil.id()){if(i.JC.FrameUtil.id()===f){e._childIdMap[f]=g=j;return false}}})}}return g},_childIdMap:{},cssFromSizePattern:function(g,f){var h={};switch(g){case 1:h.height=f.height+e.heightOffset;break;case 2:h.width=f.width;break;default:h.height=f.height+e.heightOffset;h.width=f.width;break}return h}};e._id=location.href+"_"+new Date().getTime();if(e.parent()){e.parent().FrameUtil.subscribeEvent("childData",function(g,f){if(!(f.id===e._id)){return}e.noticeChildData(f)});setTimeout(function(){e.noticeReady()},1)}JC.f.safeTimeout(function(){if(e.isChildAutoSize){JC.FrameUtil.subscribeEvent("size",function(g,f){if(!f.height){return}var h=e.childIdMap(f.id),i;if(h&&h.length){h.css(e.cssFromSizePattern(e.childSizePattern,f))}})}if(e.isChildAutoClose){JC.FrameUtil.subscribeEvent("close",function(g,f){var h=e.childIdMap(f.id),i,j;if(h&&h.length){j=JC.f.parentSelector(h,"div.UPanel");j&&j.length&&JC.Panel.getInstance(j)&&JC.Panel.getInstance(j).close()}})}JC.FrameUtil.subscribeEvent("reload",function(g,f){var h=f.url||location.href;JC.f.reloadPage(h)})},null,"JCFrameUtilInit",200);return JC.FrameUtil})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));
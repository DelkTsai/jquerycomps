(function(b,a){b(["JC.common"],function(){(function(f){window.JC=window.JC||{log:function(){}};window.Slider=JC.Slider=e;function e(h){h&&(h=f(h));if(e.getInstance(h)){return e.getInstance(h)}e.getInstance(h,this);JC.log("Slider constructor",new Date().getTime());this._model=new g(h);switch(this._model.direction()){case"vertical":this._view=new c(this._model,this);break;default:this._view=new d(this._model,this);break}this._init()}e.prototype={_init:function(){var h=this;h._initControl();h.on("cleartinterval",function(){h._model.clearInterval();h._view.setPagePosition()});h.on("cleartimeout",function(){h._model.clearTimeout()});h._initAutoMove();h._model.initedcb()&&h.on("inited",h._model.initedcb());h.trigger("inited");return this},on:function(i,h){f(this).on(i,h);return this},trigger:function(h){f(this).trigger(h);return this},move:function(h){this._view.move(h);return this},moveTo:function(h){this._view.moveTo(h);return this},totalpage:function(){return this._model.totalpage()},pointer:function(){return this._model.pointer()},page:function(h){return this._model.page(h)},layout:function(){return this._model.layout()},find:function(h){return this._model.layout().find(h)},_initControl:function(){switch(this._model.direction()){case"vertical":this._initVerticalControl();break;default:this._initHorizontalControl();break}},_initHorizontalControl:function(){var h=this;h._model.leftbutton()&&h._model.leftbutton().on("click",function(i){h.trigger("cleartimeout");h.trigger("movetoleft");h._view.move(1)}).on("mouseenter",function(){h.trigger("controlover")}).on("mouseleave",function(){h.trigger("controlout")});h._model.rightbutton()&&h._model.rightbutton().on("click",function(i){h.trigger("cleartimeout");h.trigger("movetoright");h._view.move()}).on("mouseenter",function(){h.trigger("controlover")}).on("mouseleave",function(){h.trigger("controlout")})},_initVerticalControl:function(){var h=this},_initAutoMove:function(){var h=this;if(!h._model.automove()){return}h.on("beforemove",function(i,k,j){h.trigger("cleartimeout")});h.on("movedone",function(i,k,j){if(h._model.controlover()){return}h.trigger("automove")});h._model.layout().on("mouseenter",function(i){h.trigger("cleartimeout");h.trigger("mouseenter")});h._model.layout().on("mouseleave",function(i){h.trigger("cleartimeout");h.trigger("mouseleave");h._view.setPagePosition();h.trigger("automove")});h.on("controlover",function(){h.trigger("cleartimeout");h._model.controlover(true)});h.on("controlout",function(){h.trigger("automove");h._model.controlover(false)});h.on("movetoleft",function(){h._model.moveDirection(false)});h.on("movetoright",function(){h._model.moveDirection(true)});f(h).on("automove",function(){h._model.timeout(setTimeout(function(){h._view.moveTo(h._model.automoveNewPointer())},h._model.automovems()))});h.trigger("automove");return this}};e.autoInit=true;e.init=function(i){var h=[];i&&(i=f(i));if(i&&i.length){if(e.isSlider(i)){if(e.getInstance(i)){return[e.getInstance(i)]}h.push(new e(i))}else{i.find("div.js_autoSlider, dl.js_autoSlider, ul.js_autoSlider, ol.js_autoSlider").each(function(){if(e.isSlider(this)){if(e.getInstance(f(this))){h.push(e.getInstance(f(this)));return}h.push(new e(f(this)))}})}}return h};e.getInstance=function(h,i){i&&h&&f(h).data("SliderIns",i);return h?f(h).data("SliderIns"):null};e.isSlider=function(h){h&&(h=f(h));return h&&(h.is("[sliderwidth]")||h.is("[sliderheight]"))};function g(h){this._layout=h;this._moveDirection=true;this._interval;this._timeout;this._init()}g.prototype={_init:function(){this.subitems();this.totalpage();JC.log(JC.f.printf("w:{0}, h:{1}, iw:{2}, ih:{3}, dr:{4}, si:{6}, hi:{5}, totalpage:{7}",this.width(),this.height(),this.itemwidth(),this.itemheight(),this.direction(),this.howmanyitem(),this.subitems().length,this.totalpage()));return this},layout:function(){return this._layout},leftbutton:function(){return this._layout.is("[sliderleft]")?f(this._layout.attr("sliderleft")):null},rightbutton:function(){return this._layout.is("[sliderright]")?f(this._layout.attr("sliderright")):null},direction:function(){return this._layout.attr("sliderdirection").toLowerCase()||"horizontal"},moveDirection:function(h){typeof h!="undefined"&&(this._moveDirection=h);JC.log("moveDirection",this._moveDirection);return this._moveDirection},howmanyitem:function(){return parseInt(this._layout.attr("sliderhowmanyitem"),10)||1},width:function(){return parseInt(this._layout.attr("sliderwidth"),10)||800},height:function(){return parseInt(this._layout.attr("sliderheight"),10)||230},itemwidth:function(){return parseInt(this._layout.attr("slideritemwidth"),10)||160},itemheight:function(){return parseInt(this._layout.attr("slideritemheight"),10)||230},loop:function(){return JC.f.parseBool(this._layout.attr("sliderloop"))},stepms:function(){return parseInt(this._layout.attr("sliderstepms"),10)||10},durationms:function(){return parseInt(this._layout.attr("sliderdurationms"),10)||300},automovems:function(){return parseInt(this._layout.attr("sliderautomovems"),10)||2000},automove:function(){return JC.f.parseBool(this._layout.attr("sliderautomove"))},defaultpage:function(){return parseInt(this._layout.attr("sliderdefaultpage"),10)||0},subitems:function(){if(this._layout.is("[slidersubitems]")){this._subitems=this._layout.find(this._layout.attr("slidersubitems"))}else{this._subitems=this._layout.children()}return this._subitems},totalpage:function(){this.subitems();if(this.howmanyitem()>1){this._totalpage=Math.ceil(this._subitems.length/this.howmanyitem())}else{this._totalpage=this._subitems.length}return this._totalpage},page:function(l){this.subitems();!l&&(l=0);l<0&&(l=0);l>=this.totalpage()&&(l=this.totalpage()-1);l*=this.howmanyitem();var k=[];for(var h=l,j=0;j<this.howmanyitem()&&h<this._subitems.length;h++,j++){k.push(f(this._subitems[h]))}return k},pointer:function(h){if(typeof this._pointer=="undefined"){this._pointer=this.defaultpage()}if(typeof h!="undefined"){this._pointer=this.fixpointer(h)}return this._pointer},newpointer:function(h){var i=this.pointer();h&&i--;!h&&i++;i=this.fixpointer(i);return i},fixpointer:function(h){var i=h;if(this.loop()){i<0&&(i=this.totalpage()-1);i>=this.totalpage()&&(i=0)}else{i<0&&(i=0);i>=this.totalpage()&&(i=this.totalpage()-1)}return i},automoveNewPointer:function(){var h=this.pointer();if(this.moveDirection()){h++}else{h--}if(this.loop()){if(h>=this.totalpage()){h=0}else{if(h<0){h=this.totalpage()-1}}}else{if(h>=this.totalpage()){h=this.totalpage()-2;this.moveDirection(false)}else{if(h<0){h=1;this.moveDirection(true)}}}return h},interval:function(h){typeof h!="undefined"&&(this._interval=h);return this._interval},clearInterval:function(){this.interval()&&clearInterval(this.interval())},timeout:function(h){typeof h!="undefined"&&(this._timeout=h);return this._timeout},clearTimeout:function(){this.timeout()&&clearTimeout(this.timeout())},controlover:function(h){typeof h!="undefined"&&(this._controlover=h);return this._controlover},initedcb:function(){this._layout.is("[sliderinitedcb]")&&window[this._layout.attr("sliderinitedcb")]&&(this._initedcb=window[this._layout.attr("sliderinitedcb")]);return this._initedcb}};function d(h,i){this._model=h;this._slider=i;this._itemspace=(this._model.width()-Math.floor(this._model.width()/this._model.itemwidth())*this._model.itemwidth())/(this._model.totalpage()-1);this._itemspace=parseInt(this._itemspace);this._init()}d.prototype={_init:function(){this.setPagePosition(this._model.pointer());return this},move:function(j){var h=this;j=!!j;JC.log("HorizontalView move, is backwrad",j,this._model.pointer());var i=this._model.newpointer(j);JC.log(JC.f.printf("is backwrad: {0}, pointer:{1}, new pointer:{2}",j,this._model.pointer(),i));this.moveTo(i)},moveTo:function(k){var h=this;if(!this._model.loop()){if(k<=this._model.pointer()&&this._model.pointer()===0){f(this._slider).trigger("outmin");return}if(k>=this._model.pointer()&&this._model.pointer()>=this._model.totalpage()-1){f(this._slider).trigger("outmax");return}}k=this._model.fixpointer(k);var m=this._model.pointer();if(k===m){return}var l=this._model.page(m),j=this._model.page(k);var i=l.concat(j);this._setNewPagePosition(l,j,m,k);h._model.pointer(k)},_setNewPagePosition:function(o,k,n,m){var i=this,h,j=o.concat(k),l;f(this._slider).trigger("cleartinterval");if(n<m){h=this._model.width()+this._itemspace}else{h=-(this._model.width()+this._itemspace);l=true}n===(i._model.totalpage()-1)&&m===0&&(h=this._model.width()+this._itemspace,l=false);n===0&&m===(i._model.totalpage()-1)&&(h=-(this._model.width()+this._itemspace),l=true);f.each(k,function(r,q){var p=f(q);p.css({left:h+i._model.itemwidth()*r+i._itemspace*r+"px"});p.show()});f(i._slider).trigger("beforemove",[n,m]);f.each(j,function(q,p){p.data("TMP_LEFT",p.prop("offsetLeft"))});JC.log("zzzzzzzzzz",h,this._itemspace,this._model.moveDirection());i._model.interval(JC.f.easyEffect(function(p,q){f(j).each(function(s,r){r.css({left:r.data("TMP_LEFT")+(l?p:-p)+"px"})});if(q){f(o).each(function(s,r){r.hide()});f(i._slider).trigger("movedone",[n,m]);i._model.pointer(m);i.setPagePosition()}},this._model.width(),0,this._model.durationms(),this._model.stepms()))},setPagePosition:function(m){JC.log("view setPagePosition",new Date().getTime());typeof m=="undefined"&&(m=this._model.pointer());this._model.subitems().hide();var l=this._model.page(m);for(var k=0,h=l.length;k<h;k++){l[k].css({left:k*this._model.itemwidth()+k*this._itemspace+"px"}).show()}JC.log(l.length)}};function c(h,i){this._model=h;this._slider=i;this._itemspace=0;this._init()}c.prototype={_init:function(){this.setPagePosition(this._model.pointer());return this},move:function(i){var h=this;return this},moveTo:function(i){var h=this;return this},_setNewPagePosition:function(o,k,n,m){var i=this,h,j=o.concat(k),l;return this},setPagePosition:function(i){var h=this;JC.log("view setPagePosition",new Date().getTime());return this}};f(document).ready(function(){if(!e.autoInit){return}e.init(document.body)})}(jQuery));return JC.Slider})}(typeof define==="function"&&define.amd?define:function(b,a,c){typeof b=="function"&&(c=b);typeof a=="function"&&(c=a);c&&c()},window));